<!-- Generated by SpecStory -->

# 修复单元测试错误 (2025-06-17 09:08:39)

_**User**_

修复单元测试错误

---

_**Assistant**_

# Mode: PLAN

我需要先查看当前的单元测试状态，了解具体有哪些测试失败，然后制定修复计划。让我先读取Memory Bank了解项目背景，然后运行测试来确定具体的错误。

---

Read file: memory-bank/projectbrief.md

---

Read file: memory-bank/activeContext.md

---

Read file: memory-bank/progress.md

---

现在让我运行测试来查看具体的错误情况：

---

```bash
cd /data/workspace/git/dlogcover && mkdir -p build && cd build && cmake .. && make -j$(nproc) 2>&1 | head -50
```

```
ut000520@PECI2309:/data/workspace/git/dlogcover|dev⚡ ⇒  c
                                                         cd
                                                         cd /
                                                         cd /d
                                                         cd /da
                                                         cd /dat
                                                         cd /data
                                                         cd /data/
                                                         cd /data/w
                                                         cd /data/wo
                                                         cd /data/wor
                                                         cd /data/work
                                                         cd /data/works
                                                         cd /data/worksp
                                                         cd /data/workspa
                                                         cd /data/workspac
                                                         cd /data/workspace
                                                         cd /data/workspace/
                                                         cd /data/workspace/g
                                                         cd /data/workspace/gi
                                                         cd /data/workspace/git

d
dl                                                       cd /data/workspace/git/d
                                                         cd /data/workspace/git/dlo
                                                         cd /data/workspace/git/dlog
                                                         cd /data/workspace/git/dlogc
                                                         cd /data/workspace/git/dlogco
                                                         cd /data/workspace/git/dlogcov
                                                         cd /data/workspace/git/dlogcove
                                                         cd /data/workspace/git/dlogcover
                                                         cd /data/workspace/git/dlogcover&
                                                         cd /data/workspace/git/dlogcover 
&&
                                                         cd /data/workspace/git/dlogcover 
&& m
                                                         cd /data/workspace/git/dlogcover 
&& mk
                                                         cd /data/workspace/git/dlogcover 
&& mkd
                                                         cd /data/workspace/git/dlogcover 
&& mkdi
                                                         cd /data/workspace/git/dlogcover 
&& mkdir
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p b
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p bu
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p bui
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p buil
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build &
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build &&
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && c
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd b
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd bu
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd bui
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd buil
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd build
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd build &
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd build &&
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd build && c
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd build && cm
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd build && cma
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd build && cmak
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd build && cmake
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd build && cmake .
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd build && cmake ..
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd build && cmake .. &
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd build && cmake .. &&
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd build && cmake .. && m
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd build && cmake .. && ma
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd build && cmake .. && mak
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd build && cmake .. && make
                                                         cd /data/workspace/git/dlogcover 
&& mkdir -p build && cd build && cmake .. && make -
                                                         cd /data/workspace/git/dlogcoverc
d /data/workspace/git/dlogcover& cmmkdir. &&build -j cd build    cmake ..datamakeksp$(npro
c) 2>&covehead mkdir -p build && cd build && cmake .. && make -j$(nproc) 2>&1 | head -50ro
CMake Error: Could not find CMAKE_ROOT !!!
CMake has most likely not been installed correctly.
Modules directory not found in

CMake Error: Error executing cmake::LoadCache(). Aborting.

ut000520@PECI2309:/data/workspace/git/dlogcover/build|dev⚡ ⇒
```

---

看起来CMake有问题。让我检查CMake安装并尝试直接运行测试：

---

```bash
cd /data/workspace/git/dlogcover && which cmake && cmake --version
```

---

_**User**_

cmake正常，不用检查，直接用./build.sh -t验证单元测试

---

_**Assistant**_

让我尝试使用已有的构建脚本：

---

Read file: build.sh

---

让我尝试运行构建脚本的测试：

---

```bash
cd /data/workspace/git/dlogcover && ./build.sh --test
```

```
配置项目 (Debug)...
-- Enabling code coverage support
-- Found LLVM 13.0.1
-- Using LLVMConfig.cmake in: /usr/lib/llvm-13/cmake
-- LLVM_LIBRARY_DIRS: /usr/lib/llvm-13/lib
-- LLVM_INCLUDE_DIRS: /usr/lib/llvm-13/include
-- LLVM_DEFINITIONS: -D_GNU_SOURCE -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D__STDC_LIMI
T_MACROS
-- LLVM component libraries: LLVMSupport;LLVMCore;LLVMOption;LLVMIRReader;LLVMBitReader;LLVMBitW
riter;LLVMX86CodeGen;LLVMX86Desc;LLVMX86Info
-- clangOpenMP library not found - OpenMP support will be disabled
-- CLANG_TOOLING_LIB: /usr/lib/llvm-13/lib/libclangTooling.a
-- CLANG_BASIC_LIB: /usr/lib/llvm-13/lib/libclangBasic.a
-- CLANG_AST_MATCHERS_LIB: /usr/lib/llvm-13/lib/libclangASTMatchers.a
-- CLANG_AST_LIB: /usr/lib/llvm-13/lib/libclangAST.a
-- CLANG_FRONTEND_LIB: /usr/lib/llvm-13/lib/libclangFrontend.a
-- CLANG_LEX_LIB: /usr/lib/llvm-13/lib/libclangLex.a
-- CLANG_PARSE_LIB: /usr/lib/llvm-13/lib/libclangParse.a
-- CLANG_SEMA_LIB: /usr/lib/llvm-13/lib/libclangSema.a
-- CLANG_ANALYSIS_LIB: /usr/lib/llvm-13/lib/libclangAnalysis.a
-- CLANG_DRIVER_LIB: /usr/lib/llvm-13/lib/libclangDriver.a
-- CLANG_EDIT_LIB: /usr/lib/llvm-13/lib/libclangEdit.a
-- CLANG_REWRITE_LIB: /usr/lib/llvm-13/lib/libclangRewrite.a
-- CLANG_SERIALIZATION_LIB: /usr/lib/llvm-13/lib/libclangSerialization.a
-- CLANG_OPENMP_LIB: CLANG_OPENMP_LIB-NOTFOUND
-- nlohmann_json not found via find_package, checking for header-only version
-- Found nlohmann/json.hpp in /usr/include
-- Found GoogleTest: 
-- Found Clang 
-- Using ClangConfig.cmake in: /usr/lib/cmake/clang-13
-- Found lcov: /usr/bin/lcov
-- Found genhtml: /usr/bin/genhtml
-- Configuring done
-- Generating done
-- Build files have been written to: /data/workspace/git/dlogcover/build
构建项目...
Consolidate compiler generated dependencies of target dlogcover_lib
[ 23%] Built target dlogcover_lib
Consolidate compiler generated dependencies of target dlogcover
Consolidate compiler generated dependencies of target deadlock_detection_test
Consolidate compiler generated dependencies of target concurrent_safety_test
Consolidate compiler generated dependencies of target ast_cache_test
Consolidate compiler generated dependencies of target thread_pool_test
Consolidate compiler generated dependencies of target source_manager_test
Consolidate compiler generated dependencies of target ast_analyzer_test
Consolidate compiler generated dependencies of target log_identifier_test
Consolidate compiler generated dependencies of target log_identifier_edge_cases_test
Consolidate compiler generated dependencies of target coverage_calculator_test
Consolidate compiler generated dependencies of target ast_analyzer_parallel_test
Consolidate compiler generated dependencies of target log_identifier_simple_test
Consolidate compiler generated dependencies of target command_line_parser_test
Consolidate compiler generated dependencies of target ast_cache_time_test
Consolidate compiler generated dependencies of target file_utils_test
Consolidate compiler generated dependencies of target reporter_test
[ 26%] Built target concurrent_safety_test
[ 28%] Built target deadlock_detection_test
[ 29%] Built target dlogcover
[ 31%] Built target thread_pool_test
[ 34%] Built target source_manager_test
[ 36%] Built target ast_cache_test
[ 38%] Built target ast_analyzer_parallel_test
[ 42%] Built target log_identifier_test
[ 42%] Built target log_identifier_edge_cases_test
[ 44%] Built target ast_analyzer_test
[ 46%] Built target log_identifier_simple_test
[ 48%] Built target coverage_calculator_test
[ 51%] Built target ast_cache_time_test
[ 53%] Built target file_utils_test
[ 55%] Built target reporter_test
[ 57%] Built target command_line_parser_test
Consolidate compiler generated dependencies of target config_manager_test
Consolidate compiler generated dependencies of target cmake_parser_test
Consolidate compiler generated dependencies of target path_normalizer_test
Consolidate compiler generated dependencies of target file_ownership_validator_test
Consolidate compiler generated dependencies of target log_types_test
Consolidate compiler generated dependencies of target compile_commands_manager_test
Consolidate compiler generated dependencies of target result_test
Consolidate compiler generated dependencies of target string_utils_extended_test
Consolidate compiler generated dependencies of target config_validator_extended_test
Consolidate compiler generated dependencies of target options_extended_test
[ 59%] Built target config_manager_test
[ 61%] Built target path_normalizer_test
[ 63%] Built target cmake_parser_test
[ 65%] Built target file_ownership_validator_test
[ 67%] Built target log_types_test
[ 69%] Built target compile_commands_manager_test
[ 70%] Building CXX object tests/unit/CMakeFiles/language_detector_test.dir/language_detector_te
st.cpp.o
[ 72%] Built target string_utils_extended_test
[ 73%] Building CXX object tests/unit/CMakeFiles/command_line_parser_extended_test.dir/command_l
ine_parser_extended_test.cpp.o
[ 75%] Built target config_validator_extended_test
[ 75%] Building CXX object tests/unit/CMakeFiles/options_extended_test.dir/options_extended_test
.cpp.o
[ 77%] Built target result_test
[ 78%] Building CXX object tests/integration/CMakeFiles/config_workflow_test.dir/__/common/test_
utils.cpp.o
[ 79%] Building CXX object tests/unit/CMakeFiles/cpp_analyzer_adapter_test.dir/cpp_analyzer_adap
ter_test.cpp.o
[ 80%] Building CXX object tests/unit/CMakeFiles/multi_language_analyzer_test.dir/__/common/test
_utils.cpp.o
[ 80%] Building CXX object tests/unit/CMakeFiles/go_analyzer_test.dir/__/common/test_utils.cpp.o
[ 82%] Building CXX object tests/unit/CMakeFiles/multi_language_analyzer_test.dir/multi_language
_analyzer_test.cpp.o
[ 82%] Building CXX object tests/unit/CMakeFiles/go_analyzer_test.dir/go_analyzer_test.cpp.o
[ 83%] Building CXX object tests/integration/CMakeFiles/config_workflow_test.dir/config_workflow
_test.cpp.o
[ 84%] Building CXX object tests/unit/CMakeFiles/command_line_parser_extended_test.dir/__/common
/test_utils.cpp.o
[ 85%] Building CXX object tests/unit/CMakeFiles/cpp_analyzer_adapter_test.dir/__/common/test_ut
ils.cpp.o
[ 85%] Building CXX object tests/unit/CMakeFiles/language_detector_test.dir/__/common/test_utils
.cpp.o
[ 86%] Building CXX object tests/integration/CMakeFiles/log_analysis_test.dir/log_analysis_test.
cpp.o
[ 87%] Building CXX object tests/integration/CMakeFiles/coverage_workflow_test.dir/coverage_work
flow_test.cpp.o
[ 87%] Building CXX object tests/integration/CMakeFiles/error_handling_test.dir/error_handling_t
est.cpp.o
[ 88%] Building CXX object tests/integration/CMakeFiles/error_handling_test.dir/__/common/test_u
tils.cpp.o
In file included from /usr/include/gtest/gtest.h:59,
                 from /data/workspace/git/dlogcover/tests/unit/options_extended_test.cpp:11:
/data/workspace/git/dlogcover/tests/unit/options_extended_test.cpp: In member function ‘virtual 
void dlogcover::test::OptionsExtendedTest_JsonSerializationBasic_Test::TestBody()’:
/data/workspace/git/dlogcover/tests/unit/options_extended_test.cpp:157:24: error: ‘class nlohman
n::basic_json<>’ has no member named ‘contains’
     EXPECT_TRUE(parsed.contains("version"));
                        ^~~~~~~~
make[2]: *** [tests/unit/CMakeFiles/options_extended_test.dir/build.make:76：tests/unit/CMakeFil
es/options_extended_test.dir/options_extended_test.cpp.o] 错误 1                                ma
ke[1]: *** [CMakeFiles/Makefile2:1046：tests/unit/CMakeFiles/options_extended_test.dir/all] 错
误 2                                                                                            m
ake[1]: *** 正在等待未完成的任务....
[ 88%] Building CXX object tests/integration/CMakeFiles/log_analysis_test.dir/__/common/test_uti
ls.cpp.o
[ 89%] Building CXX object tests/integration/CMakeFiles/coverage_workflow_test.dir/__/common/tes
t_utils.cpp.o
[ 90%] Linking CXX executable ../../bin/config_workflow_test
[ 91%] Linking CXX executable ../../bin/language_detector_test
[ 92%] Linking CXX executable ../../bin/command_line_parser_extended_test
[ 93%] Linking CXX executable ../../bin/go_analyzer_test
[ 94%] Linking CXX executable ../../bin/multi_language_analyzer_test
[ 94%] Built target language_detector_test
[ 94%] Built target command_line_parser_extended_test
[ 94%] Built target config_workflow_test
[ 94%] Built target go_analyzer_test
[ 94%] Built target multi_language_analyzer_test
[ 95%] Linking CXX executable ../../bin/log_analysis_test
[ 96%] Linking CXX executable ../../bin/error_handling_test
[ 96%] Built target log_analysis_test
[ 96%] Linking CXX executable ../../bin/coverage_workflow_test
[ 97%] Linking CXX executable ../../bin/cpp_analyzer_adapter_test
[ 97%] Built target error_handling_test
[ 97%] Built target coverage_workflow_test
[ 97%] Built target cpp_analyzer_adapter_test
make: *** [Makefile:166：all] 错误 2

```

---

很好！我发现了问题。编译出现错误是因为`nlohmann::json`库的版本不支持`contains`方法。`contains`方法是在较新版本的nlohmann/json中引入的，但当前系统使用的是较旧版本。

让我检查具体的错误文件：

---

Read file: tests/unit/options_extended_test.cpp

---

现在让我搜索其他使用`contains`方法的文件：

---

Model provided invalid arguments to grep tool.

---

<details>
            <summary>Grep search for "\\.contains" • **0** files</summary>
        
No results found
</details>

---

<details>
            <summary>Grep search for "contains" • **5** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `file:///data/workspace/git/dlogcover/src/core/ast_analyzer/ast_statement_analyzer.cpp` | L18 | `bool ASTStatementAnalyzer::containsLogKeywords(const std::string& text) const {` |
| `file:///data/workspace/git/dlogcover/src/core/ast_analyzer/ast_statement_analyzer.cpp` | L120 | `if (containsLogKeywords(condText)) {` |
| `file:///data/workspace/git/dlogcover/src/core/coverage/coverage_calculator.cpp` | L8 | `*   3. 优化了containsLogMacros方法，使用配置的日志函数集合进行检查` |
| `file:///data/workspace/git/dlogcover/src/core/coverage/coverage_calculator.cpp` | L191 | `isCovered = containsLogMacros(funcNode);` |
| `file:///data/workspace/git/dlogcover/src/core/coverage/coverage_calculator.cpp` | L274 | `bool CoverageCalculator::containsLogMacros(const ast_analyzer::ASTNodeInfo* node) const {` |
| `file:///data/workspace/git/dlogcover/src/core/coverage/coverage_calculator.cpp` | L305 | `if (containsLogMacros(child.get())) {` |
| `file:///data/workspace/git/dlogcover/src/core/coverage/coverage_calculator.cpp` | L324 | `// 使用containsLogMacros方法检查是否包含配置中定义的任何日志函数或宏` |
| `file:///data/workspace/git/dlogcover/src/core/coverage/coverage_calculator.cpp` | L325 | `if (containsLogMacros(node)) {` |
| `file:///data/workspace/git/dlogcover/src/core/coverage/coverage_calculator.cpp` | L374 | `isCovered = containsLogMacros(branchNode);` |
| `file:///data/workspace/git/dlogcover/src/core/coverage/coverage_calculator.cpp` | L464 | `isCovered = containsLogMacros(exceptionNode);` |
| `file:///data/workspace/git/dlogcover/src/core/coverage/coverage_calculator.cpp` | L574 | `isCovered = containsLogMacros(keyPathNode);` |
| `file:///data/workspace/git/dlogcover/src/utils/string_utils.cpp` | L257 | `bool containsSubstring(const std::string& str, const std::string& sub) {` |
| `file:///data/workspace/git/dlogcover/src/utils/string_utils.cpp` | L260 | `bool contains = str.find(sub) != std::string::npos;` |
| `file:///data/workspace/git/dlogcover/src/utils/string_utils.cpp` | L262 | `contains ? "" : "不", sub.c_str());` |
| `file:///data/workspace/git/dlogcover/src/utils/string_utils.cpp` | L264 | `return contains;` |
| `file:///data/workspace/git/dlogcover/tests/unit/string_utils_extended_test.cpp` | L234 | `TEST_F(StringUtilsExtendedTest, ContainsSubstringBasic) {` |
| `file:///data/workspace/git/dlogcover/tests/unit/string_utils_extended_test.cpp` | L235 | `EXPECT_TRUE(containsSubstring("Hello World", "World"));` |
| `file:///data/workspace/git/dlogcover/tests/unit/string_utils_extended_test.cpp` | L236 | `EXPECT_TRUE(containsSubstring("Hello World", "Hello"));` |
| `file:///data/workspace/git/dlogcover/tests/unit/string_utils_extended_test.cpp` | L237 | `EXPECT_TRUE(containsSubstring("Hello World", "o W"));` |
| `file:///data/workspace/git/dlogcover/tests/unit/string_utils_extended_test.cpp` | L238 | `EXPECT_FALSE(containsSubstring("Hello World", "world"));  // 大小写敏感` |
| `file:///data/workspace/git/dlogcover/tests/unit/string_utils_extended_test.cpp` | L239 | `EXPECT_FALSE(containsSubstring("Hello World", "xyz"));` |
| `file:///data/workspace/git/dlogcover/tests/unit/string_utils_extended_test.cpp` | L242 | `TEST_F(StringUtilsExtendedTest, ContainsSubstringEmptyStrings) {` |
| `file:///data/workspace/git/dlogcover/tests/unit/string_utils_extended_test.cpp` | L243 | `EXPECT_TRUE(containsSubstring("Hello", ""));  // 空子串应该总是被包含` |
| `file:///data/workspace/git/dlogcover/tests/unit/string_utils_extended_test.cpp` | L244 | `EXPECT_FALSE(containsSubstring("", "Hello"));  // 空字符串不包含非空子串` |
| `file:///data/workspace/git/dlogcover/tests/unit/string_utils_extended_test.cpp` | L245 | `EXPECT_TRUE(containsSubstring("", ""));  // 空字符串包含空子串` |
| `file:///data/workspace/git/dlogcover/tests/unit/string_utils_extended_test.cpp` | L248 | `TEST_F(StringUtilsExtendedTest, ContainsSubstringSameString) {` |
| `file:///data/workspace/git/dlogcover/tests/unit/string_utils_extended_test.cpp` | L249 | `EXPECT_TRUE(containsSubstring("Hello", "Hello"));` |
| `file:///data/workspace/git/dlogcover/tests/unit/options_extended_test.cpp` | L156 | `EXPECT_TRUE(parsed.contains("version"));` |

</details>

---

好的，我找到了问题。只有一个地方使用了`parsed.contains("version")`。这是nlohmann/json的新API，在旧版本中不存在。我需要将其替换为兼容的写法。

让我也检查nlohmann/json的版本和兼容性：

---

```bash
cd /data/workspace/git/dlogcover && find /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs grep -A5 -B5 "NLOHMANN_JSON_VERSION" 2>/dev/null || echo "无法找到版本信息"
```

```
ut000520@PECI2309:/data/workspace/git/dlogcover|dev⚡ ⇒  c
                                                         cd
                                                         cd /
                                                         cd /d
                                                         cd /da
                                                         cd /dat
                                                         cd /data
                                                         cd /data/
                                                         cd /data/w
                                                         cd /data/wo
                                                         cd /data/wor
                                                         cd /data/work
                                                         cd /data/works
                                                         cd /data/worksp
                                                         cd /data/workspa
                                                         cd /data/workspac
                                                         cd /data/workspace
                                                         cd /data/workspace/
                                                         cd /data/workspace/g
                                                         cd /data/workspace/gi
                                                         cd /data/workspace/git
                                                         cd /data/workspace/git/
                                                         cd /data/workspace/git/d
                                                         cd /data/workspace/git/dl
                                                         cd /data/workspace/git/dlo
                                                         cd /data/workspace/git/dlog
                                                         cd /data/workspace/git/dlogc
                                                         cd /data/workspace/git/dlogco
                                                         cd /data/workspace/git/dlogcov
                                                         cd /data/workspace/git/dlogcove
                                                         cd /data/workspace/git/dlogcover
                                                         cd /data/workspace/git/dlogcover &
                                                         cd /data/workspace/git/dlogcover &&
                                                         cd /data/workspace/git/dlogcover && f
                                                         cd /data/workspace/git/dlogcover && fi
                                                         cd /data/workspace/git/dlogcover && fin

                                                         cd /data/workspace/git/dlogcover && fin
d
                                                         cd /data/workspace/git/dlogcover && fin
d /
                                                         cd /data/workspace/git/dlogcover && fin
d /u
                                                         cd /data/workspace/git/dlogcover && fin
d /us
                                                         cd /data/workspace/git/dlogcover && fin
d /usr
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/i
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/in
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/inc
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/incl
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/inclu
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/includ
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -n
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -na
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -nam
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "j
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "js
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "jso
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.h
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hp
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp"
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -e
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -ex
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exe
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec g
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec gr
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec gre
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "n
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nl
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlo
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nloh
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohm
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohma
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohman
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann"
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {}
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \;
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; |
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | h
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | he
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | hea
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 |
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | x
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xa
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xar
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xarg
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs g
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs gr
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs gre
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs grep
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs grep -
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs grep -A
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs grep -A5
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs grep -A5 -
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs grep -A5 -B
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs grep -A5 -B5
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs grep -A5 -B5 "
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs grep -A5 -B5 "N

                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs grep -A5 -B5 "N
L
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs grep -A5 -B5 "N
LO
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs grep -A5 -B5 "N
LOH
                                                         cd /data/workspace/git/dlogcover && fin
d /usr/include -name "json.hpp" -exec grep -l "nlohmann" {} \; | head -1 | xargs grep -A5 -B5 "N
LOHM
<ERSION" 2>/dev/null || echo "无法找到版本信息"
*/

#ifndef NLOHMANN_JSON_HPP
#define NLOHMANN_JSON_HPP

#define NLOHMANN_JSON_VERSION_MAJOR 3
#define NLOHMANN_JSON_VERSION_MINOR 5
#define NLOHMANN_JSON_VERSION_PATCH 0

#include <algorithm> // all_of, find, for_each
#include <cassert> // assert
#include <ciso646> // and, not, or
#include <cstddef> // nullptr_t, ptrdiff_t, size_t
--

        result["copyright"] = "(C) 2013-2017 Niels Lohmann";
        result["name"] = "JSON for Modern C++";
        result["url"] = "https://github.com/nlohmann/json";
        result["version"]["string"] =
            std::to_string(NLOHMANN_JSON_VERSION_MAJOR) + "." +
            std::to_string(NLOHMANN_JSON_VERSION_MINOR) + "." +
            std::to_string(NLOHMANN_JSON_VERSION_PATCH);
        result["version"]["major"] = NLOHMANN_JSON_VERSION_MAJOR;
        result["version"]["minor"] = NLOHMANN_JSON_VERSION_MINOR;
        result["version"]["patch"] = NLOHMANN_JSON_VERSION_PATCH;

#ifdef _WIN32
        result["platform"] = "win32";
#elif defined __linux__
        result["platform"] = "linux";
ut000520@PECI2309:/data/workspace/git/dlogcover|dev⚡ ⇒
```

---

好的！我发现了问题。当前系统使用的是nlohmann/json 3.5.0版本，而`contains()`方法是在3.6.0版本之后才引入的。我需要将`parsed.contains("version")`替换为兼容的写法。

现在我将修复这个问题：

## 单元测试错误修复计划

基于分析，发现的问题是：

1. **nlohmann/json版本兼容性问题**：当前系统使用3.5.0版本，但代码使用了3.6.0+的`contains()`方法
2. **需要替换为兼容写法**：使用`count()`或`find() != end()`方法

## 修复方案

将`parsed.contains("version")`替换为`parsed.count("version") > 0`或`parsed.find("version") != parsed.end()`

---



---

现在让我再次运行测试，检查是否还有其他错误：

---

```bash
cd /data/workspace/git/dlogcover && ./build.sh --test
```

```
ut000520@PECI2309:/data/workspace/git/dlogcover|dev⚡ ⇒  
21: [  FAILED  ] CompileCommandsManagerTest.ParseNonexistentFile (0 ms)
21: [ RUN      ] CompileCommandsManagerTest.GetCompilerArgsExactMatch
21: [       OK ] CompileCommandsManagerTest.GetCompilerArgsExactMatch (2 ms)
21: [ RUN      ] CompileCommandsManagerTest.GetCompilerArgsSameNameMatch
21: [       OK ] CompileCommandsManagerTest.GetCompilerArgsSameNameMatch (1 ms)
21: [ RUN      ] CompileCommandsManagerTest.GetCompilerArgsFallback
21: [       OK ] CompileCommandsManagerTest.GetCompilerArgsFallback (0 ms)
21: [ RUN      ] CompileCommandsManagerTest.GetProjectDirectory
21: [       OK ] CompileCommandsManagerTest.GetProjectDirectory (1 ms)
21: [ RUN      ] CompileCommandsManagerTest.GetProjectDirectoryNotFound
21: [       OK ] CompileCommandsManagerTest.GetProjectDirectoryNotFound (0 ms)
21: [ RUN      ] CompileCommandsManagerTest.IsCompileCommandsValid
21: unknown file: Failure
21: C++ exception with description "filesystem error: status: Permission denied [/nonexistent/fi
le.json]" thrown in the test body.
21: [  FAILED  ] CompileCommandsManagerTest.IsCompileCommandsValid (0 ms)
21: [ RUN      ] CompileCommandsManagerTest.ClearFunction
21: [       OK ] CompileCommandsManagerTest.ClearFunction (1 ms)
21: [ RUN      ] CompileCommandsManagerTest.ParseCompilerCommandWithQuotes
21: [       OK ] CompileCommandsManagerTest.ParseCompilerCommandWithQuotes (2 ms)
21: [----------] 15 tests from CompileCommandsManagerTest (580 ms total)
21: 
21: [----------] Global test environment tear-down
21: [==========] 15 tests from 1 test case ran. (580 ms total)
21: [  PASSED  ] 12 tests.
21: [  FAILED  ] 3 tests, listed below:
21: [  FAILED  ] CompileCommandsManagerTest.DetectInvalidProjectDirectory
21: [  FAILED  ] CompileCommandsManagerTest.ParseNonexistentFile
21: [  FAILED  ] CompileCommandsManagerTest.IsCompileCommandsValid
21: 
21:  3 FAILED TESTS
21/34 Test #21: compile_commands_manager_test ........***Failed    0.60 sec
test 22
      Start 22: options_extended_test

22: Test command: /data/workspace/git/dlogcover/build/bin/options_extended_test
22: Environment variables: 
22:  GTEST_COLOR=1
22: Test timeout computed to be: 300
22: Running main() from /build/googletest-lWsoze/googletest-1.8.1/googletest/src/gtest_main.cc
22: [==========] Running 28 tests from 1 test case.
22: [----------] Global test environment set-up.
22: [----------] 28 tests from OptionsExtendedTest
22: [ RUN      ] OptionsExtendedTest.ValidateExistingDirectory
22: [       OK ] OptionsExtendedTest.ValidateExistingDirectory (1 ms)
22: [ RUN      ] OptionsExtendedTest.ValidateNonexistentDirectory
22: unknown file: Failure
22: C++ exception with description "filesystem error: status: Permission denied [/nonexistent/di
rectory/path]" thrown in the test body.
22: [  FAILED  ] OptionsExtendedTest.ValidateNonexistentDirectory (0 ms)
22: [ RUN      ] OptionsExtendedTest.ValidateFileAsDirectory
22: [       OK ] OptionsExtendedTest.ValidateFileAsDirectory (0 ms)
22: [ RUN      ] OptionsExtendedTest.ValidateEmptyDirectory
22: [       OK ] OptionsExtendedTest.ValidateEmptyDirectory (0 ms)
22: [ RUN      ] OptionsExtendedTest.ValidateExistingConfigFile
22: [       OK ] OptionsExtendedTest.ValidateExistingConfigFile (1 ms)
22: [ RUN      ] OptionsExtendedTest.ValidateNonexistentConfigFile
22: unknown file: Failure
22: C++ exception with description "filesystem error: status: Permission denied [/nonexistent/co
nfig.json]" thrown in the test body.
22: [  FAILED  ] OptionsExtendedTest.ValidateNonexistentConfigFile (0 ms)
22: [ RUN      ] OptionsExtendedTest.ValidateOutputFileWithValidParentDir
22: [       OK ] OptionsExtendedTest.ValidateOutputFileWithValidParentDir (0 ms)
22: [ RUN      ] OptionsExtendedTest.ValidateOutputFileWithInvalidParentDir
22: unknown file: Failure
22: C++ exception with description "filesystem error: status: Permission denied [/nonexistent/di
rectory]" thrown in the test body.
22: [  FAILED  ] OptionsExtendedTest.ValidateOutputFileWithInvalidParentDir (0 ms)
22: [ RUN      ] OptionsExtendedTest.ValidateEmptyExcludePattern
22: [       OK ] OptionsExtendedTest.ValidateEmptyExcludePattern (0 ms)
22: [ RUN      ] OptionsExtendedTest.ValidateValidExcludePatterns
22: [       OK ] OptionsExtendedTest.ValidateValidExcludePatterns (1 ms)
22: [ RUN      ] OptionsExtendedTest.JsonSerializationBasic
22: [       OK ] OptionsExtendedTest.JsonSerializationBasic (0 ms)
22: [ RUN      ] OptionsExtendedTest.JsonSerializationEmptyExcludePatterns
22: [       OK ] OptionsExtendedTest.JsonSerializationEmptyExcludePatterns (0 ms)
22: [ RUN      ] OptionsExtendedTest.JsonDeserializationValid
22: [       OK ] OptionsExtendedTest.JsonDeserializationValid (1 ms)
22: [ RUN      ] OptionsExtendedTest.JsonDeserializationMissingVersion
22: [       OK ] OptionsExtendedTest.JsonDeserializationMissingVersion (0 ms)
22: [ RUN      ] OptionsExtendedTest.JsonDeserializationInvalidVersion
22: [       OK ] OptionsExtendedTest.JsonDeserializationInvalidVersion (0 ms)
22: [ RUN      ] OptionsExtendedTest.JsonDeserializationMissingDirectory
22: [       OK ] OptionsExtendedTest.JsonDeserializationMissingDirectory (0 ms)
22: [ RUN      ] OptionsExtendedTest.JsonDeserializationWithDefaults
22: [       OK ] OptionsExtendedTest.JsonDeserializationWithDefaults (1 ms)
22: [ RUN      ] OptionsExtendedTest.JsonDeserializationInvalidLogLevel
22: [       OK ] OptionsExtendedTest.JsonDeserializationInvalidLogLevel (0 ms)
22: [ RUN      ] OptionsExtendedTest.JsonDeserializationInvalidReportFormat
22: [       OK ] OptionsExtendedTest.JsonDeserializationInvalidReportFormat (0 ms)
22: [ RUN      ] OptionsExtendedTest.JsonDeserializationMalformedJson
22: [       OK ] OptionsExtendedTest.JsonDeserializationMalformedJson (0 ms)
22: [ RUN      ] OptionsExtendedTest.IsValidFunction
22: unknown file: Failure
22: C++ exception with description "filesystem error: status: Permission denied [/nonexistent/pa
th]" thrown in the test body.
22: [  FAILED  ] OptionsExtendedTest.IsValidFunction (0 ms)
22: [ RUN      ] OptionsExtendedTest.ResetFunction
22: [       OK ] OptionsExtendedTest.ResetFunction (0 ms)
22: [ RUN      ] OptionsExtendedTest.ToStringFunction
22: [       OK ] OptionsExtendedTest.ToStringFunction (0 ms)
22: [ RUN      ] OptionsExtendedTest.EqualityOperator
22: [       OK ] OptionsExtendedTest.EqualityOperator (1 ms)
22: [ RUN      ] OptionsExtendedTest.LogLevelConversion
22: [       OK ] OptionsExtendedTest.LogLevelConversion (0 ms)
22: [ RUN      ] OptionsExtendedTest.ReportFormatConversion
22: [       OK ] OptionsExtendedTest.ReportFormatConversion (0 ms)
22: [ RUN      ] OptionsExtendedTest.InvalidReportFormatConversion
22: [       OK ] OptionsExtendedTest.InvalidReportFormatConversion (0 ms)
22: [ RUN      ] OptionsExtendedTest.JsonRoundTrip
22: [       OK ] OptionsExtendedTest.JsonRoundTrip (0 ms)
22: [----------] 28 tests from OptionsExtendedTest (6 ms total)
22: 
22: [----------] Global test environment tear-down
22: [==========] 28 tests from 1 test case ran. (6 ms total)
22: [  PASSED  ] 24 tests.
22: [  FAILED  ] 4 tests, listed below:
22: [  FAILED  ] OptionsExtendedTest.ValidateNonexistentDirectory
22: [  FAILED  ] OptionsExtendedTest.ValidateNonexistentConfigFile
22: [  FAILED  ] OptionsExtendedTest.ValidateOutputFileWithInvalidParentDir
22: [  FAILED  ] OptionsExtendedTest.IsValidFunction
22: 
22:  4 FAILED TESTS
22/34 Test #22: options_extended_test ................***Failed    0.03 sec
test 23
      Start 23: string_utils_extended_test

23: Test command: /data/workspace/git/dlogcover/build/bin/string_utils_extended_test
23: Environment variables: 
23:  GTEST_COLOR=1
23: Test timeout computed to be: 300
23: Running main() from /build/googletest-lWsoze/googletest-1.8.1/googletest/src/gtest_main.cc
23: [==========] Running 39 tests from 1 test case.
23: [----------] Global test environment set-up.
23: [----------] 39 tests from StringUtilsExtendedTest
23: [ RUN      ] StringUtilsExtendedTest.Utf8ValidString
23: [       OK ] StringUtilsExtendedTest.Utf8ValidString (1 ms)
23: [ RUN      ] StringUtilsExtendedTest.Utf8AsciiString
23: [       OK ] StringUtilsExtendedTest.Utf8AsciiString (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.Utf8EmptyString
23: [       OK ] StringUtilsExtendedTest.Utf8EmptyString (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.Utf8InvalidSequence
23: [       OK ] StringUtilsExtendedTest.Utf8InvalidSequence (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.Utf8TruncatedSequence
23: [       OK ] StringUtilsExtendedTest.Utf8TruncatedSequence (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.Utf8FourByteSequence
23: [       OK ] StringUtilsExtendedTest.Utf8FourByteSequence (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.FormatBasicString
23: [       OK ] StringUtilsExtendedTest.FormatBasicString (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.FormatMultipleArgs
23: [       OK ] StringUtilsExtendedTest.FormatMultipleArgs (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.FormatEmptyString
23: [       OK ] StringUtilsExtendedTest.FormatEmptyString (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.FormatNullPointer
23: [       OK ] StringUtilsExtendedTest.FormatNullPointer (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.FormatLargeString
23: [       OK ] StringUtilsExtendedTest.FormatLargeString (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.FormatSpecialCharacters
23: [       OK ] StringUtilsExtendedTest.FormatSpecialCharacters (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.TryParseIntValid
23: [       OK ] StringUtilsExtendedTest.TryParseIntValid (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.TryParseIntInvalid
23: [       OK ] StringUtilsExtendedTest.TryParseIntInvalid (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.TryParseIntBoundary
23: [       OK ] StringUtilsExtendedTest.TryParseIntBoundary (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.TryParseDoubleValid
23: [       OK ] StringUtilsExtendedTest.TryParseDoubleValid (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.TryParseDoubleInvalid
23: [       OK ] StringUtilsExtendedTest.TryParseDoubleInvalid (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.TryParseDoubleScientificNotation
23: [       OK ] StringUtilsExtendedTest.TryParseDoubleScientificNotation (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.RepeatBasic
23: [       OK ] StringUtilsExtendedTest.RepeatBasic (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.RepeatZeroTimes
23: [       OK ] StringUtilsExtendedTest.RepeatZeroTimes (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.RepeatNegativeTimes
23: [       OK ] StringUtilsExtendedTest.RepeatNegativeTimes (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.RepeatEmptyString
23: [       OK ] StringUtilsExtendedTest.RepeatEmptyString (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.RepeatSingleChar
23: [       OK ] StringUtilsExtendedTest.RepeatSingleChar (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.ContainsSubstringBasic
23: [       OK ] StringUtilsExtendedTest.ContainsSubstringBasic (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.ContainsSubstringEmptyStrings
23: [       OK ] StringUtilsExtendedTest.ContainsSubstringEmptyStrings (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.ContainsSubstringSameString
23: [       OK ] StringUtilsExtendedTest.ContainsSubstringSameString (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.ReplaceAllBasic
23: [       OK ] StringUtilsExtendedTest.ReplaceAllBasic (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.ReplaceAllMultipleOccurrences
23: [       OK ] StringUtilsExtendedTest.ReplaceAllMultipleOccurrences (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.ReplaceAllNoMatches
23: [       OK ] StringUtilsExtendedTest.ReplaceAllNoMatches (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.ReplaceAllEmptyReplacements
23: [       OK ] StringUtilsExtendedTest.ReplaceAllEmptyReplacements (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.ReplaceAllOverlappingPatterns
23: [       OK ] StringUtilsExtendedTest.ReplaceAllOverlappingPatterns (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.SplitLargeString
23: [       OK ] StringUtilsExtendedTest.SplitLargeString (1 ms)
23: [ RUN      ] StringUtilsExtendedTest.JoinLargeVector
23: [       OK ] StringUtilsExtendedTest.JoinLargeVector (1 ms)
23: [ RUN      ] StringUtilsExtendedTest.TrimOnlyWhitespace
23: [       OK ] StringUtilsExtendedTest.TrimOnlyWhitespace (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.TrimMixedWhitespace
23: [       OK ] StringUtilsExtendedTest.TrimMixedWhitespace (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.CaseConversionSpecialChars
23: [       OK ] StringUtilsExtendedTest.CaseConversionSpecialChars (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.ReplaceEmptyPattern
23: [       OK ] StringUtilsExtendedTest.ReplaceEmptyPattern (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.ReplaceWithSelf
23: [       OK ] StringUtilsExtendedTest.ReplaceWithSelf (0 ms)
23: [ RUN      ] StringUtilsExtendedTest.ReplaceToEmpty
23: [       OK ] StringUtilsExtendedTest.ReplaceToEmpty (0 ms)
23: [----------] 39 tests from StringUtilsExtendedTest (4 ms total)
23: 
23: [----------] Global test environment tear-down
23: [==========] 39 tests from 1 test case ran. (4 ms total)
23: [  PASSED  ] 39 tests.
23/34 Test #23: string_utils_extended_test ...........   Passed    0.02 sec
test 24
      Start 24: log_types_test

24: Test command: /data/workspace/git/dlogcover/build/bin/log_types_test
24: Environment variables: 
24:  GTEST_COLOR=1
24: Test timeout computed to be: 300
24: Running main() from /build/googletest-lWsoze/googletest-1.8.1/googletest/src/gtest_main.cc
24: [==========] Running 16 tests from 1 test case.
24: [----------] Global test environment set-up.
24: [----------] 16 tests from LogTypesTest
24: [ RUN      ] LogTypesTest.LogLevelToString
24: [       OK ] LogTypesTest.LogLevelToString (0 ms)
24: [ RUN      ] LogTypesTest.ParseLogLevelValid
24: [       OK ] LogTypesTest.ParseLogLevelValid (0 ms)
24: [ RUN      ] LogTypesTest.ParseLogLevelCaseInsensitive
24: [       OK ] LogTypesTest.ParseLogLevelCaseInsensitive (0 ms)
24: [ RUN      ] LogTypesTest.ParseLogLevelInvalid
24: [       OK ] LogTypesTest.ParseLogLevelInvalid (0 ms)
24: [ RUN      ] LogTypesTest.LogLevelComparison
24: [       OK ] LogTypesTest.LogLevelComparison (0 ms)
24: [ RUN      ] LogTypesTest.LogLevelEnumValues
24: [       OK ] LogTypesTest.LogLevelEnumValues (0 ms)
24: [ RUN      ] LogTypesTest.LogLevelRoundTrip
24: [       OK ] LogTypesTest.LogLevelRoundTrip (0 ms)
24: [ RUN      ] LogTypesTest.LogLevelStringView
24: [       OK ] LogTypesTest.LogLevelStringView (0 ms)
24: [ RUN      ] LogTypesTest.ParseLogLevelWhitespace
24: [       OK ] LogTypesTest.ParseLogLevelWhitespace (0 ms)
24: [ RUN      ] LogTypesTest.ParseLogLevelEmptyAndWhitespace
24: [       OK ] LogTypesTest.ParseLogLevelEmptyAndWhitespace (0 ms)
24: [ RUN      ] LogTypesTest.IsLogLevelEnabled
24: [       OK ] LogTypesTest.IsLogLevelEnabled (0 ms)
24: [ RUN      ] LogTypesTest.LogLevelStringConsistency
24: [       OK ] LogTypesTest.LogLevelStringConsistency (0 ms)
24: [ RUN      ] LogTypesTest.AllLogLevelsSupported
24: [       OK ] LogTypesTest.AllLogLevelsSupported (0 ms)
24: [ RUN      ] LogTypesTest.ParseLogLevelExceptionMessage
24: [       OK ] LogTypesTest.ParseLogLevelExceptionMessage (0 ms)
24: [ RUN      ] LogTypesTest.ParseLogLevelPerformance
24: [       OK ] LogTypesTest.ParseLogLevelPerformance (0 ms)
24: [ RUN      ] LogTypesTest.DefaultLogLevel
24: [       OK ] LogTypesTest.DefaultLogLevel (0 ms)
24: [----------] 16 tests from LogTypesTest (1 ms total)
24: 
24: [----------] Global test environment tear-down
24: [==========] 16 tests from 1 test case ran. (1 ms total)
24: [  PASSED  ] 16 tests.
24/34 Test #24: log_types_test .......................   Passed    0.02 sec
test 25
      Start 25: config_validator_extended_test

25: Test command: /data/workspace/git/dlogcover/build/bin/config_validator_extended_test
25: Environment variables: 
25:  GTEST_COLOR=1
25: Test timeout computed to be: 300
25: Running main() from /build/googletest-lWsoze/googletest-1.8.1/googletest/src/gtest_main.cc
25: [==========] Running 14 tests from 1 test case.
25: [----------] Global test environment set-up.
25: [----------] 14 tests from ConfigValidatorExtendedTest
25: [ RUN      ] ConfigValidatorExtendedTest.VersionValidation
25: [       OK ] ConfigValidatorExtendedTest.VersionValidation (1 ms)
25: [ RUN      ] ConfigValidatorExtendedTest.NestedFormatValidation
25: [       OK ] ConfigValidatorExtendedTest.NestedFormatValidation (0 ms)
25: [ RUN      ] ConfigValidatorExtendedTest.SimplifiedFormatValidation
25: [       OK ] ConfigValidatorExtendedTest.SimplifiedFormatValidation (0 ms)
25: [ RUN      ] ConfigValidatorExtendedTest.ConfigFileErrorHandling
25: [       OK ] ConfigValidatorExtendedTest.ConfigFileErrorHandling (0 ms)
25: [ RUN      ] ConfigValidatorExtendedTest.TypeValidationErrors
25: [       OK ] ConfigValidatorExtendedTest.TypeValidationErrors (0 ms)
25: [ RUN      ] ConfigValidatorExtendedTest.OutputConfigValidation
25: [       OK ] ConfigValidatorExtendedTest.OutputConfigValidation (1 ms)
25: [ RUN      ] ConfigValidatorExtendedTest.LogLevelValidation
25: [       OK ] ConfigValidatorExtendedTest.LogLevelValidation (0 ms)
25: [ RUN      ] ConfigValidatorExtendedTest.ReportFormatValidation
25: [       OK ] ConfigValidatorExtendedTest.ReportFormatValidation (0 ms)
25: [ RUN      ] ConfigValidatorExtendedTest.ScanConfigValidation
25: [       OK ] ConfigValidatorExtendedTest.ScanConfigValidation (1 ms)
25: [ RUN      ] ConfigValidatorExtendedTest.LoadFromConfigFile
25: [       OK ] ConfigValidatorExtendedTest.LoadFromConfigFile (0 ms)
25: [ RUN      ] ConfigValidatorExtendedTest.LoadFromEnvironment
25: [       OK ] ConfigValidatorExtendedTest.LoadFromEnvironment (0 ms)
25: [ RUN      ] ConfigValidatorExtendedTest.EnvironmentErrorHandling
25: [       OK ] ConfigValidatorExtendedTest.EnvironmentErrorHandling (0 ms)
25: [ RUN      ] ConfigValidatorExtendedTest.AllLogLevelParsing
25: [       OK ] ConfigValidatorExtendedTest.AllLogLevelParsing (1 ms)
25: [ RUN      ] ConfigValidatorExtendedTest.AllReportFormatParsing
25: [       OK ] ConfigValidatorExtendedTest.AllReportFormatParsing (0 ms)
25: [----------] 14 tests from ConfigValidatorExtendedTest (4 ms total)
25: 
25: [----------] Global test environment tear-down
25: [==========] 14 tests from 1 test case ran. (4 ms total)
25: [  PASSED  ] 14 tests.
25/34 Test #25: config_validator_extended_test .......   Passed    0.02 sec
test 26
      Start 26: command_line_parser_extended_test

26: Test command: /data/workspace/git/dlogcover/build/bin/command_line_parser_extended_test
26: Environment variables: 
26:  GTEST_COLOR=1
26: Test timeout computed to be: 300
26: Running main() from /build/googletest-lWsoze/googletest-1.8.1/googletest/src/gtest_main.cc
26: [==========] Running 20 tests from 1 test case.
26: [----------] Global test environment set-up.
26: [----------] 20 tests from CommandLineParserExtendedTest
26: [ RUN      ] CommandLineParserExtendedTest.HelpOption
26: 
26: DLogCover - C++代码日志覆盖分析工具 v0.1.0
26: 用法: dlogcover [选项]
26: 
26: 主要选项:
26:   -h, --help                 显示帮助信息
26:   -v, --version              显示版本信息
26:   -d, --directory <path>     指定扫描目录 (默认: ./)
26:   -o, --output <path>        指定输出报告路径 (默认: ./dlogcover_report_<timestamp>.txt)
26:   -c, --config <path>        指定配置文件路径 (默认: ./dlogcover.json)
26:   -e, --exclude <pattern>    排除符合模式的文件或目录 (可多次使用)
26:   -l, --log-level <level>    指定最低日志级别进行过滤 (debug, info, warning, critical, fatal
, all)
26:   -f, --format <format>      指定报告格式 (text, json)
26:   -p, --log-path <path>      指定日志文件路径 (默认: dlogcover_<timestamp>.log)
26:   -I, --include-path <path>  头文件搜索路径 (可多次使用)
26:   -q, --quiet                静默模式，减少输出信息
26:       --verbose              详细输出模式，显示更多调试信息
26: 
26: 高级选项:
26:       --compiler-arg <arg>   传递给编译器的参数 (可多次使用)
26:       --include-system-headers  包含系统头文件分析
26:       --threshold <value>    覆盖率阈值设置 (0.0-1.0)
26:       --parallel <num>       并行分析线程数 (默认: 1)
26: 
26: 环境变量:
26:   DLOGCOVER_DIRECTORY       等同于 -d 选项
26:   DLOGCOVER_OUTPUT          等同于 -o 选项
26:   DLOGCOVER_CONFIG          等同于 -c 选项
26:   DLOGCOVER_LOG_LEVEL       等同于 -l 选项
26:   DLOGCOVER_REPORT_FORMAT   等同于 -f 选项
26:   DLOGCOVER_EXCLUDE         排除模式列表，使用冒号分隔
26:   DLOGCOVER_LOG_PATH        等同于 -p 选项
26: 
26: 配置文件格式 (JSON):
26: 支持两种格式：
26: 
26: 1. 完整嵌套格式 (推荐):
26: {
26:   "project": {
26:     "name": "my-project",
26:     "directory": "./src",
26:     "build_directory": "./build"
26:   },
26:   "scan": {
26:     "directories": ["src", "include"],
26:     "file_extensions": [".cpp", ".h"],
26:     "exclude_patterns": ["build/*", "test/*"]
26:   },
26:   "output": {
26:     "report_file": "./report.txt",
26:     "log_file": "./dlogcover.log",
26:     "log_level": "debug"
26:   },
26:   "log_functions": {
26:     "qt": {
26:       "enabled": true,
26:       "functions": ["qDebug", "qInfo"]
26:     },
26:     "custom": {
26:       "enabled": true,
26:       "functions": {
26:         "debug": ["LOG_DEBUG"],
26:         "info": ["LOG_INFO"]
26:       }
26:     }
26:   }
26: }
26: 
26: 2. 简化格式 (兼容):
26: {
26:   "directory": "./src",
26:   "output": "./report.txt",
26:   "log_level": "debug",
26:   "exclude": ["build/*", "test/*"],
26:   "log_path": "./dlogcover.log"
26: }
26: 
26: 优先级:
26:   命令行参数 > 配置文件 > 环境变量 > 默认值
26: 
26: 示例:
26:   dlogcover -d /path/to/source -o report.txt
26:   dlogcover -c config.json -e "build/*" -e "test/*"
26:   dlogcover -I ./include --compiler-arg "-std=c++17" --parallel 4
26:   dlogcover --quiet -f json -o report.json
26:   DLOGCOVER_DIRECTORY=./src DLOGCOVER_LOG_LEVEL=debug dlogcover
26: 
26: 
26: DLogCover - C++代码日志覆盖分析工具 v0.1.0
26: 用法: dlogcover [选项]
26: 
26: 主要选项:
26:   -h, --help                 显示帮助信息
26:   -v, --version              显示版本信息
26:   -d, --directory <path>     指定扫描目录 (默认: ./)
26:   -o, --output <path>        指定输出报告路径 (默认: ./dlogcover_report_<timestamp>.txt)
26:   -c, --config <path>        指定配置文件路径 (默认: ./dlogcover.json)
26:   -e, --exclude <pattern>    排除符合模式的文件或目录 (可多次使用)
26:   -l, --log-level <level>    指定最低日志级别进行过滤 (debug, info, warning, critical, fatal
, all)
26:   -f, --format <format>      指定报告格式 (text, json)
26:   -p, --log-path <path>      指定日志文件路径 (默认: dlogcover_<timestamp>.log)
26:   -I, --include-path <path>  头文件搜索路径 (可多次使用)
26:   -q, --quiet                静默模式，减少输出信息
26:       --verbose              详细输出模式，显示更多调试信息
26: 
26: 高级选项:
26:       --compiler-arg <arg>   传递给编译器的参数 (可多次使用)
26:       --include-system-headers  包含系统头文件分析
26:       --threshold <value>    覆盖率阈值设置 (0.0-1.0)
26:       --parallel <num>       并行分析线程数 (默认: 1)
26: 
26: 环境变量:
26:   DLOGCOVER_DIRECTORY       等同于 -d 选项
26:   DLOGCOVER_OUTPUT          等同于 -o 选项
26:   DLOGCOVER_CONFIG          等同于 -c 选项
26:   DLOGCOVER_LOG_LEVEL       等同于 -l 选项
26:   DLOGCOVER_REPORT_FORMAT   等同于 -f 选项
26:   DLOGCOVER_EXCLUDE         排除模式列表，使用冒号分隔
26:   DLOGCOVER_LOG_PATH        等同于 -p 选项
26: 
26: 配置文件格式 (JSON):
26: 支持两种格式：
26: 
26: 1. 完整嵌套格式 (推荐):
26: {
26:   "project": {
26:     "name": "my-project",
26:     "directory": "./src",
26:     "build_directory": "./build"
26:   },
26:   "scan": {
26:     "directories": ["src", "include"],
26:     "file_extensions": [".cpp", ".h"],
26:     "exclude_patterns": ["build/*", "test/*"]
26:   },
26:   "output": {
26:     "report_file": "./report.txt",
26:     "log_file": "./dlogcover.log",
26:     "log_level": "debug"
26:   },
26:   "log_functions": {
26:     "qt": {
26:       "enabled": true,
26:       "functions": ["qDebug", "qInfo"]
26:     },
26:     "custom": {
26:       "enabled": true,
26:       "functions": {
26:         "debug": ["LOG_DEBUG"],
26:         "info": ["LOG_INFO"]
26:       }
26:     }
26:   }
26: }
26: 
26: 2. 简化格式 (兼容):
26: {
26:   "directory": "./src",
26:   "output": "./report.txt",
26:   "log_level": "debug",
26:   "exclude": ["build/*", "test/*"],
26:   "log_path": "./dlogcover.log"
26: }
26: 
26: 优先级:
26:   命令行参数 > 配置文件 > 环境变量 > 默认值
26: 
26: 示例:
26:   dlogcover -d /path/to/source -o report.txt
26:   dlogcover -c config.json -e "build/*" -e "test/*"
26:   dlogcover -I ./include --compiler-arg "-std=c++17" --parallel 4
26:   dlogcover --quiet -f json -o report.json
26:   DLOGCOVER_DIRECTORY=./src DLOGCOVER_LOG_LEVEL=debug dlogcover
26: 
26: [       OK ] CommandLineParserExtendedTest.HelpOption (0 ms)
26: [ RUN      ] CommandLineParserExtendedTest.VersionOption
26: DLogCover v0.1.0
26: DLogCover v0.1.0
26: [       OK ] CommandLineParserExtendedTest.VersionOption (0 ms)
26: [ RUN      ] CommandLineParserExtendedTest.DirectoryOption
26: [       OK ] CommandLineParserExtendedTest.DirectoryOption (0 ms)
26: [ RUN      ] CommandLineParserExtendedTest.OutputOption
26: [       OK ] CommandLineParserExtendedTest.OutputOption (1 ms)
26: [ RUN      ] CommandLineParserExtendedTest.ConfigOption
26: [       OK ] CommandLineParserExtendedTest.ConfigOption (0 ms)
26: [ RUN      ] CommandLineParserExtendedTest.ExcludeOption
26: [       OK ] CommandLineParserExtendedTest.ExcludeOption (0 ms)
26: [ RUN      ] CommandLineParserExtendedTest.LogLevelOption
26: [       OK ] CommandLineParserExtendedTest.LogLevelOption (1 ms)
26: [ RUN      ] CommandLineParserExtendedTest.ReportFormatOption
26: [       OK ] CommandLineParserExtendedTest.ReportFormatOption (0 ms)
26: [ RUN      ] CommandLineParserExtendedTest.LogPathOption
26: [       OK ] CommandLineParserExtendedTest.LogPathOption (0 ms)
26: [ RUN      ] CommandLineParserExtendedTest.IncludePathOption
26: [       OK ] CommandLineParserExtendedTest.IncludePathOption (0 ms)
26: [ RUN      ] CommandLineParserExtendedTest.VerbosityOptions
26: [       OK ] CommandLineParserExtendedTest.VerbosityOptions (0 ms)
26: [ RUN      ] CommandLineParserExtendedTest.CompilerArgOption
26: [       OK ] CommandLineParserExtendedTest.CompilerArgOption (0 ms)
26: [ RUN      ] CommandLineParserExtendedTest.IncludeSystemHeadersOption
26: [       OK ] CommandLineParserExtendedTest.IncludeSystemHeadersOption (0 ms)
26: [ RUN      ] CommandLineParserExtendedTest.ThresholdOption
26: [       OK ] CommandLineParserExtendedTest.ThresholdOption (1 ms)
26: [ RUN      ] CommandLineParserExtendedTest.ParallelOption
26: [       OK ] CommandLineParserExtendedTest.ParallelOption (0 ms)
26: [ RUN      ] CommandLineParserExtendedTest.UnknownOption
26: [       OK ] CommandLineParserExtendedTest.UnknownOption (0 ms)
26: [ RUN      ] CommandLineParserExtendedTest.MissingOptionValue
26: [       OK ] CommandLineParserExtendedTest.MissingOptionValue (0 ms)
26: [ RUN      ] CommandLineParserExtendedTest.ComplexOptionCombination
26: [       OK ] CommandLineParserExtendedTest.ComplexOptionCombination (0 ms)
26: [ RUN      ] CommandLineParserExtendedTest.PathValidation
26: [       OK ] CommandLineParserExtendedTest.PathValidation (0 ms)
26: [ RUN      ] CommandLineParserExtendedTest.DefaultValues
26: [       OK ] CommandLineParserExtendedTest.DefaultValues (0 ms)
26: [----------] 20 tests from CommandLineParserExtendedTest (3 ms total)
26: 
26: [----------] Global test environment tear-down
26: [==========] 20 tests from 1 test case ran. (3 ms total)
26: [  PASSED  ] 20 tests.
26/34 Test #26: command_line_parser_extended_test ....   Passed    0.02 sec
test 27
      Start 27: language_detector_test

27: Test command: /data/workspace/git/dlogcover/build/bin/language_detector_test
27: Environment variables: 
27:  GTEST_COLOR=1
27: Test timeout computed to be: 300
27: Running main() from /build/googletest-lWsoze/googletest-1.8.1/googletest/src/gtest_main.cc
27: [==========] Running 7 tests from 1 test case.
27: [----------] Global test environment set-up.
27: [----------] 7 tests from LanguageDetectorTest
27: [ RUN      ] LanguageDetectorTest.DetectCppFiles
27: /data/workspace/git/dlogcover/tests/unit/language_detector_test.cpp:29: Failure
27: Expected equality of these values:
27:   LanguageDetector::detectLanguage("test.C")
27:     Which is: 4-byte object <02-00 00-00>
27:   SourceLanguage::CPP
27:     Which is: 4-byte object <00-00 00-00>
27: [  FAILED  ] LanguageDetectorTest.DetectCppFiles (0 ms)
27: [ RUN      ] LanguageDetectorTest.DetectGoFiles
27: [       OK ] LanguageDetectorTest.DetectGoFiles (0 ms)
27: [ RUN      ] LanguageDetectorTest.DetectUnknownFiles
27: [       OK ] LanguageDetectorTest.DetectUnknownFiles (0 ms)
27: [ RUN      ] LanguageDetectorTest.CaseInsensitive
27: [       OK ] LanguageDetectorTest.CaseInsensitive (0 ms)
27: [ RUN      ] LanguageDetectorTest.PathHandling
27: [       OK ] LanguageDetectorTest.PathHandling (0 ms)
27: [ RUN      ] LanguageDetectorTest.ExtensionCheckers
27: [       OK ] LanguageDetectorTest.ExtensionCheckers (0 ms)
27: [ RUN      ] LanguageDetectorTest.LanguageNames
27: [       OK ] LanguageDetectorTest.LanguageNames (0 ms)
27: [----------] 7 tests from LanguageDetectorTest (0 ms total)
27: 
27: [----------] Global test environment tear-down
27: [==========] 7 tests from 1 test case ran. (0 ms total)
27: [  PASSED  ] 6 tests.
27: [  FAILED  ] 1 test, listed below:
27: [  FAILED  ] LanguageDetectorTest.DetectCppFiles
27: 
27:  1 FAILED TEST
27/34 Test #27: language_detector_test ...............***Failed    0.02 sec
test 28
      Start 28: multi_language_analyzer_test

28: Test command: /data/workspace/git/dlogcover/build/bin/multi_language_analyzer_test
28: Environment variables: 
28:  GTEST_COLOR=1
28: Test timeout computed to be: 300
28: Running main() from /build/googletest-lWsoze/googletest-1.8.1/googletest/src/gtest_main.cc
28: [==========] Running 11 tests from 1 test case.
28: [----------] Global test environment set-up.
28: [----------] 11 tests from MultiLanguageAnalyzerTest
28: [ RUN      ] MultiLanguageAnalyzerTest.BasicConstruction
28: [       OK ] MultiLanguageAnalyzerTest.BasicConstruction (0 ms)
28: [ RUN      ] MultiLanguageAnalyzerTest.CppOnlyMode
28: /data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:176: Failure
28: Value of: cppResult.isSuccess()
28:   Actual: false
28: Expected: true
28: C++文件分析应该成功
28: [  FAILED  ] MultiLanguageAnalyzerTest.CppOnlyMode (1 ms)
28: [ RUN      ] MultiLanguageAnalyzerTest.GoOnlyMode
28: sh: 1: /tmp/dlogcover_go_request.json: Permission denied
28: /data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:205: Failure
28: Value of: cppResult.isSuccess()
28:   Actual: false
28: Expected: true
28: C++文件应该被跳过但不报错
28: [  FAILED  ] MultiLanguageAnalyzerTest.GoOnlyMode (3 ms)
28: [ RUN      ] MultiLanguageAnalyzerTest.AutoDetectMode
28: /data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:226: Failure
28: Value of: cppResult.isSuccess()
28:   Actual: false
28: Expected: true
28: C++文件分析应该成功
28: [  FAILED  ] MultiLanguageAnalyzerTest.AutoDetectMode (1 ms)
28: [ RUN      ] MultiLanguageAnalyzerTest.InvalidAnalysisMode
28: /data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:248: Failure
28: Value of: result.isSuccess()
28:   Actual: false
28: Expected: true
28: 无效模式应该回退到默认行为
28: [  FAILED  ] MultiLanguageAnalyzerTest.InvalidAnalysisMode (0 ms)
28: [ RUN      ] MultiLanguageAnalyzerTest.NonExistentFile
28: [       OK ] MultiLanguageAnalyzerTest.NonExistentFile (1 ms)
28: [ RUN      ] MultiLanguageAnalyzerTest.EmptyFile
28: /data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:276: Failure
28: Value of: result.isSuccess()
28:   Actual: false
28: Expected: true
28: 空文件应该能正常处理
28: [  FAILED  ] MultiLanguageAnalyzerTest.EmptyFile (0 ms)
28: [ RUN      ] MultiLanguageAnalyzerTest.BatchAnalysis
28: /data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:304: Failure
28: Value of: result.isSuccess()
28:   Actual: false
28: Expected: true
28: 文件 /tmp/dlogcover_test_multi_analyzer/test1.cpp 分析应该成功
28: /data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:304: Failure
28: Value of: result.isSuccess()
28:   Actual: false
28: Expected: true
28: 文件 /tmp/dlogcover_test_multi_analyzer/test2.cpp 分析应该成功
28: [  FAILED  ] MultiLanguageAnalyzerTest.BatchAnalysis (1 ms)
28: [ RUN      ] MultiLanguageAnalyzerTest.Statistics
28: /data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:321: Failure
28: Value of: result.isSuccess()
28:   Actual: false
28: Expected: true
28: [  FAILED  ] MultiLanguageAnalyzerTest.Statistics (0 ms)
28: [ RUN      ] MultiLanguageAnalyzerTest.GoToolUnavailable
28: [       OK ] MultiLanguageAnalyzerTest.GoToolUnavailable (0 ms)
28: [ RUN      ] MultiLanguageAnalyzerTest.ParallelMode
28: [       OK ] MultiLanguageAnalyzerTest.ParallelMode (1 ms)
28: [----------] 11 tests from MultiLanguageAnalyzerTest (8 ms total)
28: 
28: [----------] Global test environment tear-down
28: [==========] 11 tests from 1 test case ran. (9 ms total)
28: [  PASSED  ] 4 tests.
28: [  FAILED  ] 7 tests, listed below:
28: [  FAILED  ] MultiLanguageAnalyzerTest.CppOnlyMode
28: [  FAILED  ] MultiLanguageAnalyzerTest.GoOnlyMode
28: [  FAILED  ] MultiLanguageAnalyzerTest.AutoDetectMode
28: [  FAILED  ] MultiLanguageAnalyzerTest.InvalidAnalysisMode
28: [  FAILED  ] MultiLanguageAnalyzerTest.EmptyFile
28: [  FAILED  ] MultiLanguageAnalyzerTest.BatchAnalysis
28: [  FAILED  ] MultiLanguageAnalyzerTest.Statistics
28: 
28:  7 FAILED TESTS
28/34 Test #28: multi_language_analyzer_test .........***Failed    0.03 sec
test 29
      Start 29: go_analyzer_test

29: Test command: /data/workspace/git/dlogcover/build/bin/go_analyzer_test
29: Environment variables: 
29:  GTEST_COLOR=1
29: Test timeout computed to be: 300
29: Running main() from /build/googletest-lWsoze/googletest-1.8.1/googletest/src/gtest_main.cc
29: [==========] Running 16 tests from 1 test case.
29: [----------] Global test environment set-up.
29: [----------] 16 tests from GoAnalyzerTest
29: [ RUN      ] GoAnalyzerTest.BasicConstruction
29: [       OK ] GoAnalyzerTest.BasicConstruction (1 ms)
29: [ RUN      ] GoAnalyzerTest.StandardLogRecognition
29: sh: 1: /tmp/dlogcover_go_request.json: Permission denied
29: [       OK ] GoAnalyzerTest.StandardLogRecognition (3 ms)
29: [ RUN      ] GoAnalyzerTest.SlogRecognition
29: sh: 1: /tmp/dlogcover_go_request.json: Permission denied
29: [       OK ] GoAnalyzerTest.SlogRecognition (3 ms)
29: [ RUN      ] GoAnalyzerTest.LogrusRecognition
29: sh: 1: /tmp/dlogcover_go_request.json: Permission denied
29: [       OK ] GoAnalyzerTest.LogrusRecognition (3 ms)
29: [ RUN      ] GoAnalyzerTest.ZapRecognition
29: sh: 1: /tmp/dlogcover_go_request.json: Permission denied
29: [       OK ] GoAnalyzerTest.ZapRecognition (3 ms)
29: [ RUN      ] GoAnalyzerTest.GolibRecognition
29: sh: 1: /tmp/dlogcover_go_request.json: Permission denied
29: [       OK ] GoAnalyzerTest.GolibRecognition (2 ms)
29: [ RUN      ] GoAnalyzerTest.MixedLogRecognition
29: sh: 1: /tmp/dlogcover_go_request.json: Permission denied
29: [       OK ] GoAnalyzerTest.MixedLogRecognition (3 ms)
29: [ RUN      ] GoAnalyzerTest.NonExistentFile
29: [       OK ] GoAnalyzerTest.NonExistentFile (0 ms)
29: [ RUN      ] GoAnalyzerTest.EmptyFile
29: sh: 1: /tmp/dlogcover_go_request.json: Permission denied
29: [       OK ] GoAnalyzerTest.EmptyFile (3 ms)
29: [ RUN      ] GoAnalyzerTest.InvalidGoFile
29: sh: 1: /tmp/dlogcover_go_request.json: Permission denied
29: [       OK ] GoAnalyzerTest.InvalidGoFile (3 ms)
29: [ RUN      ] GoAnalyzerTest.ParallelMode
29: [       OK ] GoAnalyzerTest.ParallelMode (0 ms)
29: [ RUN      ] GoAnalyzerTest.BatchAnalysis
29: sh: 1: --mode=batch: not found
29: sh: 1: /tmp/dlogcover_go_request.json: Permission denied
29: sh: 1: /tmp/dlogcover_go_request.json: Permission denied
29: sh: 1: /tmp/dlogcover_go_request.json: Permission denied
29: [       OK ] GoAnalyzerTest.BatchAnalysis (11 ms)
29: [ RUN      ] GoAnalyzerTest.Statistics
29: sh: 1: /tmp/dlogcover_go_request.json: Permission denied
29: [       OK ] GoAnalyzerTest.Statistics (2 ms)
29: [ RUN      ] GoAnalyzerTest.GoToolUnavailable
29: [       OK ] GoAnalyzerTest.GoToolUnavailable (1 ms)
29: [ RUN      ] GoAnalyzerTest.TimeoutSetting
29: [       OK ] GoAnalyzerTest.TimeoutSetting (0 ms)
29: [ RUN      ] GoAnalyzerTest.CustomLogLibraryConfig
29: sh: 1: /tmp/dlogcover_go_request.json: Permission denied
29: [       OK ] GoAnalyzerTest.CustomLogLibraryConfig (3 ms)
29: [----------] 16 tests from GoAnalyzerTest (41 ms total)
29: 
29: [----------] Global test environment tear-down
29: [==========] 16 tests from 1 test case ran. (41 ms total)
29: [  PASSED  ] 16 tests.
29/34 Test #29: go_analyzer_test .....................   Passed    0.06 sec
test 30
      Start 30: cpp_analyzer_adapter_test

30: Test command: /data/workspace/git/dlogcover/build/bin/cpp_analyzer_adapter_test
30: Environment variables: 
30:  GTEST_COLOR=1
30: Test timeout computed to be: 300
30: Running main() from /build/googletest-lWsoze/googletest-1.8.1/googletest/src/gtest_main.cc
30: [==========] Running 15 tests from 1 test case.
30: [----------] Global test environment set-up.
30: [----------] 15 tests from CppAnalyzerAdapterTest
30: [ RUN      ] CppAnalyzerAdapterTest.BasicConstruction
30: [       OK ] CppAnalyzerAdapterTest.BasicConstruction (1 ms)
30: [ RUN      ] CppAnalyzerAdapterTest.SimpleFileAnalysis
30: [       OK ] CppAnalyzerAdapterTest.SimpleFileAnalysis (0 ms)
30: [ RUN      ] CppAnalyzerAdapterTest.ComplexFileAnalysis
30: [       OK ] CppAnalyzerAdapterTest.ComplexFileAnalysis (1 ms)
30: [ RUN      ] CppAnalyzerAdapterTest.HeaderFileAnalysis
30: [       OK ] CppAnalyzerAdapterTest.HeaderFileAnalysis (0 ms)
30: [ RUN      ] CppAnalyzerAdapterTest.CustomLogFunctionRecognition
30: [       OK ] CppAnalyzerAdapterTest.CustomLogFunctionRecognition (1 ms)
30: [ RUN      ] CppAnalyzerAdapterTest.NonExistentFile
30: [       OK ] CppAnalyzerAdapterTest.NonExistentFile (0 ms)
30: [ RUN      ] CppAnalyzerAdapterTest.EmptyFile
30: [       OK ] CppAnalyzerAdapterTest.EmptyFile (0 ms)
30: [ RUN      ] CppAnalyzerAdapterTest.InvalidCppFile
30: [       OK ] CppAnalyzerAdapterTest.InvalidCppFile (0 ms)
30: [ RUN      ] CppAnalyzerAdapterTest.GetUnderlyingAnalyzer
30: [       OK ] CppAnalyzerAdapterTest.GetUnderlyingAnalyzer (0 ms)
30: [ RUN      ] CppAnalyzerAdapterTest.ParallelMode
30: [       OK ] CppAnalyzerAdapterTest.ParallelMode (1 ms)
30: [ RUN      ] CppAnalyzerAdapterTest.Statistics
30: [       OK ] CppAnalyzerAdapterTest.Statistics (0 ms)
30: [ RUN      ] CppAnalyzerAdapterTest.BatchAnalysis
30: [       OK ] CppAnalyzerAdapterTest.BatchAnalysis (1 ms)
30: [ RUN      ] CppAnalyzerAdapterTest.MissingCompileCommands
30: [       OK ] CppAnalyzerAdapterTest.MissingCompileCommands (0 ms)
30: [ RUN      ] CppAnalyzerAdapterTest.QtLogFunctionRecognition
30: [       OK ] CppAnalyzerAdapterTest.QtLogFunctionRecognition (1 ms)
30: [ RUN      ] CppAnalyzerAdapterTest.ExceptionHandlingLogs
30: [       OK ] CppAnalyzerAdapterTest.ExceptionHandlingLogs (0 ms)
30: [----------] 15 tests from CppAnalyzerAdapterTest (7 ms total)
30: 
30: [----------] Global test environment tear-down
30: [==========] 15 tests from 1 test case ran. (7 ms total)
30: [  PASSED  ] 15 tests.
30/34 Test #30: cpp_analyzer_adapter_test ............   Passed    0.03 sec
test 31
      Start 31: integration_config_workflow_test

31: Test command: /data/workspace/git/dlogcover/build/bin/config_workflow_test
31: Environment variables: 
31:  GTEST_COLOR=1
31: Test timeout computed to be: 600
31: Running main() from /build/googletest-lWsoze/googletest-1.8.1/googletest/src/gtest_main.cc
31: [==========] Running 4 tests from 1 test case.
31: [----------] Global test environment set-up.
31: [----------] 4 tests from ConfigWorkflowTest
31: [ RUN      ] ConfigWorkflowTest.BasicConfigLoad
31: 2025-06-17 09:35:48.286 [INFO] 日志系统初始化，级别: DEBUG
31: 2025-06-17 09:35:48.287 [DEBUG] 配置管理器初始化，加载内置默认配置
31: 2025-06-17 09:35:48.287 [DEBUG] 创建默认配置: 项目目录=
31: 2025-06-17 09:35:48.287 [DEBUG] 编译命令管理器初始化
31: 2025-06-17 09:35:48.287 [INFO] 加载配置文件: /tmp/config_test__5036/test_config.json
31: 2025-06-17 09:35:48.287 [DEBUG] 配置文件解析成功
31: 2025-06-17 09:35:48.287 [DEBUG] 验证配置
31: 2025-06-17 09:35:48.287 [INFO] 配置文件加载成功
31: 2025-06-17 09:35:48.287 [DEBUG] 配置管理器销毁
31: 2025-06-17 09:35:48.287 [DEBUG] 编译命令管理器销毁
31: 2025-06-17 09:35:48.287 [INFO] 日志系统关闭
31: [       OK ] ConfigWorkflowTest.BasicConfigLoad (1 ms)
31: [ RUN      ] ConfigWorkflowTest.InvalidConfig
31: 2025-06-17 09:35:48.287 [INFO] 日志系统初始化，级别: DEBUG
31: 2025-06-17 09:35:48.287 [DEBUG] 配置管理器初始化，加载内置默认配置
31: 2025-06-17 09:35:48.287 [DEBUG] 创建默认配置: 项目目录=
31: 2025-06-17 09:35:48.287 [DEBUG] 编译命令管理器初始化
31: 2025-06-17 09:35:48.287 [INFO] 加载配置文件: /tmp/config_test__7330/test_config.json
31: 2025-06-17 09:35:48.287 [DEBUG] 配置文件解析成功
31: 2025-06-17 09:35:48.287 [DEBUG] 验证配置
31: 2025-06-17 09:35:48.287 [INFO] 配置文件加载成功
31: 2025-06-17 09:35:48.287 [DEBUG] 验证配置
31: 2025-06-17 09:35:48.287 [DEBUG] 配置管理器销毁
31: 2025-06-17 09:35:48.287 [DEBUG] 编译命令管理器销毁
31: 2025-06-17 09:35:48.287 [INFO] 日志系统关闭
31: [       OK ] ConfigWorkflowTest.InvalidConfig (0 ms)
31: [ RUN      ] ConfigWorkflowTest.ConfigValidation
31: 2025-06-17 09:35:48.287 [INFO] 日志系统初始化，级别: DEBUG
31: 2025-06-17 09:35:48.288 [DEBUG] 配置管理器初始化，加载内置默认配置
31: 2025-06-17 09:35:48.288 [DEBUG] 创建默认配置: 项目目录=
31: 2025-06-17 09:35:48.288 [DEBUG] 编译命令管理器初始化
31: 2025-06-17 09:35:48.288 [INFO] 加载配置文件: /tmp/config_test__3000/test_config.json
31: 2025-06-17 09:35:48.288 [DEBUG] 配置文件解析成功
31: 2025-06-17 09:35:48.288 [DEBUG] 验证配置
31: 2025-06-17 09:35:48.288 [ERROR] 扫描目录列表不能为空
31: 2025-06-17 09:35:48.288 [DEBUG] 配置管理器销毁
31: 2025-06-17 09:35:48.288 [DEBUG] 编译命令管理器销毁
31: 2025-06-17 09:35:48.288 [INFO] 日志系统关闭
31: [       OK ] ConfigWorkflowTest.ConfigValidation (1 ms)
31: [ RUN      ] ConfigWorkflowTest.CommandLineOverride
31: 2025-06-17 09:35:48.288 [INFO] 日志系统初始化，级别: DEBUG
31: 2025-06-17 09:35:48.288 [DEBUG] 配置管理器初始化，加载内置默认配置
31: 2025-06-17 09:35:48.288 [DEBUG] 创建默认配置: 项目目录=
31: 2025-06-17 09:35:48.288 [DEBUG] 编译命令管理器初始化
31: 2025-06-17 09:35:48.288 [INFO] 加载配置文件: /tmp/config_test__7202/test_config.json
31: 2025-06-17 09:35:48.288 [DEBUG] 配置文件解析成功
31: 2025-06-17 09:35:48.288 [DEBUG] 验证配置
31: 2025-06-17 09:35:48.288 [INFO] 配置文件加载成功
31: 2025-06-17 09:35:48.288 [DEBUG] 从环境变量加载选项
31: 2025-06-17 09:35:48.288 [INFO] 成功从环境变量加载选项
31: 2025-06-17 09:35:48.288 [DEBUG] 开始验证选项
31: 2025-06-17 09:35:48.288 [DEBUG] 验证目录路径: /tmp/config_test__7202/override_dir
31: 2025-06-17 09:35:48.288 [DEBUG] 验证文件路径: , 检查父目录: 0
31: 2025-06-17 09:35:48.288 [DEBUG] 验证文件路径: , 检查父目录: 1
31: 2025-06-17 09:35:48.288 [DEBUG] 选项验证通过
31: 2025-06-17 09:35:48.288 [DEBUG] 合并命令行选项
31: 2025-06-17 09:35:48.288 [DEBUG] 设置项目目录: /tmp/config_test__7202/override_dir
31: 2025-06-17 09:35:48.288 [DEBUG] 配置管理器销毁
31: 2025-06-17 09:35:48.288 [DEBUG] 编译命令管理器销毁
31: 2025-06-17 09:35:48.288 [INFO] 日志系统关闭
31: [       OK ] ConfigWorkflowTest.CommandLineOverride (0 ms)
31: [----------] 4 tests from ConfigWorkflowTest (2 ms total)
31: 
31: [----------] Global test environment tear-down
31: [==========] 4 tests from 1 test case ran. (2 ms total)
31: [  PASSED  ] 4 tests.
31/34 Test #31: integration_config_workflow_test .....   Passed    0.02 sec
test 32
      Start 32: integration_log_analysis_test

32: Test command: /data/workspace/git/dlogcover/build/bin/log_analysis_test
32: Environment variables: 
32:  GTEST_COLOR=1
32: Test timeout computed to be: 600
32: Running main() from /build/googletest-lWsoze/googletest-1.8.1/googletest/src/gtest_main.cc
32: [==========] Running 3 tests from 1 test case.
32: [----------] Global test environment set-up.
32: [----------] 3 tests from LogAnalysisTest
32: [ RUN      ] LogAnalysisTest.ConfigurationValidation
32: 2025-06-17 09:35:48.310 [INFO] 日志系统初始化，级别: INFO
32: 2025-06-17 09:35:48.310 [INFO] 日志系统关闭
32: [       OK ] LogAnalysisTest.ConfigurationValidation (1 ms)
32: [ RUN      ] LogAnalysisTest.EnvironmentSetup
32: 2025-06-17 09:35:48.310 [INFO] 日志系统初始化，级别: INFO
32: 2025-06-17 09:35:48.310 [INFO] 日志系统关闭
32: [       OK ] LogAnalysisTest.EnvironmentSetup (0 ms)
32: [ RUN      ] LogAnalysisTest.PlaceholderForProjectLevelTests
32: 2025-06-17 09:35:48.310 [INFO] 日志系统初始化，级别: INFO
32: 2025-06-17 09:35:48.310 [INFO] 日志系统关闭
32: [       OK ] LogAnalysisTest.PlaceholderForProjectLevelTests (1 ms)
32: [----------] 3 tests from LogAnalysisTest (2 ms total)
32: 
32: [----------] Global test environment tear-down
32: [==========] 3 tests from 1 test case ran. (2 ms total)
32: [  PASSED  ] 3 tests.
32/34 Test #32: integration_log_analysis_test ........   Passed    0.02 sec
test 33
      Start 33: integration_coverage_workflow_test

33: Test command: /data/workspace/git/dlogcover/build/bin/coverage_workflow_test
33: Environment variables: 
33:  GTEST_COLOR=1
33: Test timeout computed to be: 600
33: Running main() from /build/googletest-lWsoze/googletest-1.8.1/googletest/src/gtest_main.cc
33: [==========] Running 3 tests from 1 test case.
33: [----------] Global test environment set-up.
33: [----------] 3 tests from CoverageWorkflowTest
33: [ RUN      ] CoverageWorkflowTest.ConfigurationValidation
33: 2025-06-17 09:35:48.333 [INFO] 日志系统初始化，级别: INFO
33: 2025-06-17 09:35:48.334 [INFO] 日志系统关闭
33: [       OK ] CoverageWorkflowTest.ConfigurationValidation (1 ms)
33: [ RUN      ] CoverageWorkflowTest.ComponentInitialization
33: 2025-06-17 09:35:48.334 [INFO] 日志系统初始化，级别: INFO
33: 2025-06-17 09:35:48.334 [INFO] 文件归属验证器统计信息:
33: 2025-06-17 09:35:48.334 [INFO] FileOwnershipValidator Statistics:
33:   Total Validations: 0
33:   Cache Hits: 0 (0%)
33:   Strict Matches: 0
33:   Canonical Matches: 0
33:   Smart Matches: 0
33:   Fuzzy Matches: 0
33:   Cache Size: 0
33: 
33: 2025-06-17 09:35:48.335 [INFO] 共构建了 24 个日志函数名
33: 2025-06-17 09:35:48.335 [INFO] 共构建了 24 个日志函数名
33: 2025-06-17 09:35:48.335 [INFO] 文件归属验证器统计信息:
33: 2025-06-17 09:35:48.335 [INFO] FileOwnershipValidator Statistics:
33:   Total Validations: 0
33:   Cache Hits: 0 (0%)
33:   Strict Matches: 0
33:   Canonical Matches: 0
33:   Smart Matches: 0
33:   Fuzzy Matches: 0
33:   Cache Size: 0
33: 
33: 2025-06-17 09:35:48.335 [INFO] 日志系统关闭
33: [       OK ] CoverageWorkflowTest.ComponentInitialization (1 ms)
33: [ RUN      ] CoverageWorkflowTest.PlaceholderForProjectLevelTests
33: 2025-06-17 09:35:48.335 [INFO] 日志系统初始化，级别: INFO
33: 2025-06-17 09:35:48.335 [INFO] 日志系统关闭
33: [       OK ] CoverageWorkflowTest.PlaceholderForProjectLevelTests (0 ms)
33: [----------] 3 tests from CoverageWorkflowTest (2 ms total)
33: 
33: [----------] Global test environment tear-down
33: [==========] 3 tests from 1 test case ran. (2 ms total)
33: [  PASSED  ] 3 tests.
33/34 Test #33: integration_coverage_workflow_test ...   Passed    0.03 sec
test 34
      Start 34: integration_error_handling_test

34: Test command: /data/workspace/git/dlogcover/build/bin/error_handling_test
34: Environment variables: 
34:  GTEST_COLOR=1
34: Test timeout computed to be: 600
34: Running main() from /build/googletest-lWsoze/googletest-1.8.1/googletest/src/gtest_main.cc
34: [==========] Running 4 tests from 1 test case.
34: [----------] Global test environment set-up.
34: [----------] 4 tests from ErrorHandlingTest
34: [ RUN      ] ErrorHandlingTest.ConfigurationErrorHandling
34: 2025-06-17 09:35:48.360 [INFO] 日志系统初始化，级别: INFO
34: 2025-06-17 09:35:48.361 [INFO] 日志系统关闭
34: [       OK ] ErrorHandlingTest.ConfigurationErrorHandling (1 ms)
34: [ RUN      ] ErrorHandlingTest.FileSystemErrorHandling
34: 2025-06-17 09:35:48.361 [INFO] 日志系统初始化，级别: INFO
34: 2025-06-17 09:35:48.361 [INFO] 日志系统关闭
34: [       OK ] ErrorHandlingTest.FileSystemErrorHandling (0 ms)
34: [ RUN      ] ErrorHandlingTest.ComponentInitializationErrorHandling
34: 2025-06-17 09:35:48.361 [INFO] 日志系统初始化，级别: INFO
34: 2025-06-17 09:35:48.361 [INFO] 文件归属验证器统计信息:
34: 2025-06-17 09:35:48.361 [INFO] FileOwnershipValidator Statistics:
34:   Total Validations: 0
34:   Cache Hits: 0 (0%)
34:   Strict Matches: 0
34:   Canonical Matches: 0
34:   Smart Matches: 0
34:   Fuzzy Matches: 0
34:   Cache Size: 0
34: 
34: 2025-06-17 09:35:48.362 [INFO] 共构建了 24 个日志函数名
34: 2025-06-17 09:35:48.362 [INFO] 文件归属验证器统计信息:
34: 2025-06-17 09:35:48.362 [INFO] FileOwnershipValidator Statistics:
34:   Total Validations: 0
34:   Cache Hits: 0 (0%)
34:   Strict Matches: 0
34:   Canonical Matches: 0
34:   Smart Matches: 0
34:   Fuzzy Matches: 0
34:   Cache Size: 0
34: 
34: 2025-06-17 09:35:48.362 [INFO] 日志系统关闭
34: [       OK ] ErrorHandlingTest.ComponentInitializationErrorHandling (1 ms)
34: [ RUN      ] ErrorHandlingTest.PlaceholderForProjectLevelErrorTests
34: 2025-06-17 09:35:48.362 [INFO] 日志系统初始化，级别: INFO
34: 2025-06-17 09:35:48.362 [INFO] 日志系统关闭
34: [       OK ] ErrorHandlingTest.PlaceholderForProjectLevelErrorTests (0 ms)
34: [----------] 4 tests from ErrorHandlingTest (2 ms total)
34: 
34: [----------] Global test environment tear-down
34: [==========] 4 tests from 1 test case ran. (2 ms total)
34: [  PASSED  ] 4 tests.
34/34 Test #34: integration_error_handling_test ......   Passed    0.02 sec

88% tests passed, 4 tests failed out of 34

Total Test time (real) =  58.67 sec

The following tests FAILED:
         21 - compile_commands_manager_test (Failed)
         22 - options_extended_test (Failed)
         27 - language_detector_test (Failed)
         28 - multi_language_analyzer_test (Failed)
Errors while running CTest
Output from these tests are in: /data/workspace/git/dlogcover/build/Testing/Temporary/LastTest.l
og
Use "--rerun-failed --output-on-failure" to re-run the failed cases verbosely.

```

---

很好！编译问题已经解决，`nlohmann::json`的`contains`方法已经修复。现在我看到有几个测试失败，主要是：

1. **文件系统权限问题** - 一些测试试图访问不存在的路径时遇到"Permission denied"错误
2. **语言检测问题** - `LanguageDetectorTest.DetectCppFiles`中的枚举值不匹配
3. **多语言分析器问题** - 分析失败
4. **编译命令管理器问题** - 一些路径相关的问题

让我逐一修复这些问题。首先查看语言检测器的问题：

---

Read file: tests/unit/language_detector_test.cpp

---

现在我需要查看`SourceLanguage`枚举的定义，看看为什么值不匹配：

---

<details>
            <summary>Searched codebase "SourceLanguage enum definition" • **25** results</summary>
        
| File | Lines |
|------|-------|
| `include/dlogcover/core/language_detector/language_detector.h` | L1-68 |
| `src/core/language_detector/language_detector.cpp` | L1-69 |
| `src/core/analyzer/multi_language_analyzer.cpp` | L454-498 |
| `tests/unit/language_detector_test.cpp` | L80-85 |
| `include/dlogcover/core/analyzer/multi_language_analyzer.h` | L167-241 |
| `include/dlogcover/core/analyzer/multi_language_analyzer.h` | L34-96 |
| `include/dlogcover/core/analyzer/multi_language_analyzer.h` | L96-167 |
| `include/dlogcover/core/analyzer/i_language_analyzer.h` | L1-72 |
| `include/dlogcover/core/analyzer/multi_language_analyzer.h` | L241-268 |
| `src/core/analyzer/multi_language_analyzer.cpp` | L38-68 |
| `src/core/analyzer/multi_language_analyzer.cpp` | L202-250 |
| `.tasks/go_language_support_research_20241220.md` | L626-662 |
| `include/dlogcover/core/analyzer/multi_language_analyzer.h` | L1-34 |
| `tests/unit/language_detector_test.cpp` | L1-44 |
| `src/core/analyzer/multi_language_analyzer.cpp` | L550-584 |
| `src/core/analyzer/multi_language_analyzer.cpp` | L498-550 |
| `src/core/analyzer/multi_language_analyzer.cpp` | L68-119 |
| `src/core/analyzer/multi_language_analyzer.cpp` | L1-38 |
| `.tasks/go_language_support_research_20241220.md` | L193-273 |
| `src/core/analyzer/multi_language_analyzer.cpp` | L250-300 |
| `src/core/analyzer/multi_language_analyzer.cpp` | L300-344 |
| `tests/unit/language_detector_test.cpp` | L44-80 |
| `.tasks/go_language_support_research_20241220.md` | L527-576 |
| `src/core/analyzer/multi_language_analyzer.cpp` | L151-202 |
| `.tasks/go_language_support_research_20241220.md` | L576-626 |

</details>

---

现在我看到问题了。根据搜索结果，枚举定义如下：

```cpp
enum class SourceLanguage {
    CPP,        ///< C++语言 (值为0)
    GO,         ///< Go语言   (值为1)
    UNKNOWN     ///< 未知语言类型 (值为2)
};
```

但是测试失败显示：
- 期望值：`SourceLanguage::CPP` (值为0)
- 实际值：值为2

这意味着`detectLanguage("test.C")`返回的是`SourceLanguage::UNKNOWN`而不是`SourceLanguage::CPP`。

让我查看语言检测器的实现，特别是对`.C`扩展名的处理：

---

Read file: src/core/language_detector/language_detector.cpp

---

现在我发现问题了！在`hasAnyExtension`函数中，`getFileExtension`会将扩展名转换为小写，所以`"test.C"`会变成`".c"`，但在`CPP_EXTENSIONS`列表中，我们有`".C"`（大写），而转换后的小写`".c"`找不到匹配。

问题在第80行的转换：

```cpp
// 转换为小写以进行不区分大小写的比较
std::transform(extension.begin(), extension.end(), extension.begin(), ::tolower);
```

但在`CPP_EXTENSIONS`列表中，我们有大写的`".C"`，这样就不匹配了。我们需要同时将扩展名列表中的内容也转换为小写，或者在比较时进行大小写不敏感的比较。

让我修复这个问题：

---



---

现在让我也检查头文件中是否有静态成员变量声明，需要保持一致：

---

Read file: include/dlogcover/core/language_detector/language_detector.h

---

好的，头文件只是声明了静态成员，具体的定义在源文件中。现在让我修复其他权限相关的测试问题。我需要查看测试中试图访问不存在路径的代码：

---

<details>
            <summary>Grep search for "/nonexistent" • **7** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `file:///data/workspace/git/dlogcover/tests/unit/ast_analyzer_test.cpp` | L438 | `auto result = astAnalyzer_->analyze("/nonexistent/file.cpp");` |
| `file:///data/workspace/git/dlogcover/tests/unit/config_validator_extended_test.cpp` | L128 | `EXPECT_FALSE(validator_->validateConfig("/nonexistent/config.json"));` |
| `file:///data/workspace/git/dlogcover/tests/unit/command_line_parser_extended_test.cpp` | L98 | `const char* args3[] = {"dlogcover", "-d", "/nonexistent/directory"};` |
| `file:///data/workspace/git/dlogcover/tests/unit/command_line_parser_extended_test.cpp` | L143 | `const char* args3[] = {"dlogcover", "-c", "/nonexistent/config.json"};` |
| `file:///data/workspace/git/dlogcover/tests/unit/compile_commands_manager_test.cpp` | L113 | `std::string invalidDir = "/nonexistent/directory/path";` |
| `file:///data/workspace/git/dlogcover/tests/unit/compile_commands_manager_test.cpp` | L188 | `bool result = manager_->parseCompileCommands("/nonexistent/file.json");` |
| `file:///data/workspace/git/dlogcover/tests/unit/compile_commands_manager_test.cpp` | L296 | `EXPECT_FALSE(manager_->isCompileCommandsValid("/nonexistent/file.json"));` |
| `file:///data/workspace/git/dlogcover/tests/unit/source_manager_test.cpp` | L414 | `config_.scan.directories = {"/nonexistent_directory_12345"};` |
| `file:///data/workspace/git/dlogcover/tests/unit/options_extended_test.cpp` | L67 | `options_->directory = "/nonexistent/directory/path";` |
| `file:///data/workspace/git/dlogcover/tests/unit/options_extended_test.cpp` | L99 | `options_->configPath = "/nonexistent/config.json";` |
| `file:///data/workspace/git/dlogcover/tests/unit/options_extended_test.cpp` | L114 | `options_->output_file = "/nonexistent/directory/output.txt";` |
| `file:///data/workspace/git/dlogcover/tests/unit/options_extended_test.cpp` | L285 | `options_->directory = "/nonexistent/path";` |
| `file:///data/workspace/git/dlogcover/tests/unit/cli/options_test.cpp` | L72 | `options.directory = "/nonexistent/directory";` |
| `file:///data/workspace/git/dlogcover/tests/unit/cli/options_test.cpp` | L82 | `options.configPath = "/nonexistent/config.json";` |
| `file:///data/workspace/git/dlogcover/tests/unit/cli/options_test.cpp` | L92 | `options.outputPath = "/nonexistent/output/file.txt";` |

</details>

---

问题出现在一些测试试图验证不存在的路径时，这些路径不仅不存在，还触发了"Permission denied"错误，而不是预期的"文件不存在"错误。这通常是因为路径父目录不存在或没有权限。

让我先看看`options_extended_test.cpp`中的具体问题：

---

Read file: tests/unit/options_extended_test.cpp

---

问题是使用了绝对路径如`/nonexistent/directory/path`，当系统尝试检查这个路径时，可能会在检查父目录权限时遇到"Permission denied"错误。

让我们修改这些测试，使用临时目录中的不存在路径，这样更安全：

---



---



---



---



---

现在修复`compile_commands_manager_test.cpp`中类似的问题：

---

Read file: tests/unit/compile_commands_manager_test.cpp

---



---



---



---

现在让我重新运行测试看看有没有改善：

---

```bash
cd /data/workspace/git/dlogcover && ./build.sh --test 2>&1 | tail -20
```

```
34: [ RUN      ] ErrorHandlingTest.PlaceholderForProjectLevelErrorTests
34: 2025-06-17 09:41:58.977 [INFO] 日志系统初始化，级别: INFO
34: 2025-06-17 09:41:58.978 [INFO] 日志系统关闭
34: [       OK ] ErrorHandlingTest.PlaceholderForProjectLevelErrorTests (1 ms)
34: [----------] 4 tests from ErrorHandlingTest (3 ms total)
34: 
34: [----------] Global test environment tear-down
34: [==========] 4 tests from 1 test case ran. (3 ms total)
34: [  PASSED  ] 4 tests.
34/34 Test #34: integration_error_handling_test ......   Passed    0.02 sec

97% tests passed, 1 tests failed out of 34

Total Test time (real) =  58.69 sec

The following tests FAILED:
         28 - multi_language_analyzer_test (Failed)
Errors while running CTest
Output from these tests are in: /data/workspace/git/dlogcover/build/Testing/Temporary/LastTest.l
og
Use "--rerun-failed --output-on-failure" to re-run the failed cases verbosely.

```

---

很好！现在只剩下一个测试失败了：`multi_language_analyzer_test`。让我们详细看看这个测试的错误：

---

```bash
cd /data/workspace/git/dlogcover/build && ./bin/multi_language_analyzer_test
```

```
Running main() from /build/googletest-lWsoze/googletest-1.8.1/googletest/src/gtest_main.cc
[==========] Running 11 tests from 1 test case.
[----------] Global test environment set-up.
[----------] 11 tests from MultiLanguageAnalyzerTest
[ RUN      ] MultiLanguageAnalyzerTest.BasicConstruction
[       OK ] MultiLanguageAnalyzerTest.BasicConstruction (0 ms)
[ RUN      ] MultiLanguageAnalyzerTest.CppOnlyMode
/data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:176: Failure
Value of: cppResult.isSuccess()
  Actual: false
Expected: true
C++文件分析应该成功
[  FAILED  ] MultiLanguageAnalyzerTest.CppOnlyMode (0 ms)
[ RUN      ] MultiLanguageAnalyzerTest.GoOnlyMode
sh: 1: /tmp/dlogcover_go_request.json: Permission denied
/data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:205: Failure
Value of: cppResult.isSuccess()
  Actual: false
Expected: true
C++文件应该被跳过但不报错
[  FAILED  ] MultiLanguageAnalyzerTest.GoOnlyMode (2 ms)
[ RUN      ] MultiLanguageAnalyzerTest.AutoDetectMode
/data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:226: Failure
Value of: cppResult.isSuccess()
  Actual: false
Expected: true
C++文件分析应该成功
[  FAILED  ] MultiLanguageAnalyzerTest.AutoDetectMode (1 ms)
[ RUN      ] MultiLanguageAnalyzerTest.InvalidAnalysisMode
/data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:248: Failure
Value of: result.isSuccess()
  Actual: false
Expected: true
无效模式应该回退到默认行为
[  FAILED  ] MultiLanguageAnalyzerTest.InvalidAnalysisMode (0 ms)
[ RUN      ] MultiLanguageAnalyzerTest.NonExistentFile
[       OK ] MultiLanguageAnalyzerTest.NonExistentFile (0 ms)
[ RUN      ] MultiLanguageAnalyzerTest.EmptyFile
/data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:276: Failure
Value of: result.isSuccess()
  Actual: false
Expected: true
空文件应该能正常处理
[  FAILED  ] MultiLanguageAnalyzerTest.EmptyFile (1 ms)
[ RUN      ] MultiLanguageAnalyzerTest.BatchAnalysis
/data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:304: Failure
Value of: result.isSuccess()
  Actual: false
Expected: true
文件 /tmp/dlogcover_test_multi_analyzer/test1.cpp 分析应该成功
/data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:304: Failure
Value of: result.isSuccess()
  Actual: false
Expected: true
文件 /tmp/dlogcover_test_multi_analyzer/test2.cpp 分析应该成功
[  FAILED  ] MultiLanguageAnalyzerTest.BatchAnalysis (0 ms)
[ RUN      ] MultiLanguageAnalyzerTest.Statistics
/data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:321: Failure
Value of: result.isSuccess()
  Actual: false
Expected: true
[  FAILED  ] MultiLanguageAnalyzerTest.Statistics (1 ms)
[ RUN      ] MultiLanguageAnalyzerTest.GoToolUnavailable
[       OK ] MultiLanguageAnalyzerTest.GoToolUnavailable (0 ms)
[ RUN      ] MultiLanguageAnalyzerTest.ParallelMode
[       OK ] MultiLanguageAnalyzerTest.ParallelMode (0 ms)
[----------] 11 tests from MultiLanguageAnalyzerTest (6 ms total)

[----------] Global test environment tear-down
[==========] 11 tests from 1 test case ran. (6 ms total)
[  PASSED  ] 4 tests.
[  FAILED  ] 7 tests, listed below:
[  FAILED  ] MultiLanguageAnalyzerTest.CppOnlyMode
[  FAILED  ] MultiLanguageAnalyzerTest.GoOnlyMode
[  FAILED  ] MultiLanguageAnalyzerTest.AutoDetectMode
[  FAILED  ] MultiLanguageAnalyzerTest.InvalidAnalysisMode
[  FAILED  ] MultiLanguageAnalyzerTest.EmptyFile
[  FAILED  ] MultiLanguageAnalyzerTest.BatchAnalysis
[  FAILED  ] MultiLanguageAnalyzerTest.Statistics

 7 FAILED TESTS

```

---

问题很明显，多语言分析器测试中的C++文件分析都失败了。让我查看测试代码以了解具体的测试设置：

---

Read file: tests/unit/multi_language_analyzer_test.cpp

---

问题在于测试依赖于实际的C++文件分析，但分析器可能因为缺少编译命令或其他依赖而失败。让我查看测试的设置部分：

---

Read file: tests/unit/multi_language_analyzer_test.cpp

---

我看到问题了。测试创建了C++文件，但是没有设置编译命令信息，这样AST分析器可能无法正确解析C++代码。另外，测试没有为ConfigManager提供有效的配置文件。

让我检查一下CppAnalyzerAdapter需要什么才能正常工作。这个问题很可能是因为缺少编译命令信息。

让我修改测试，创建一个简化的测试方案，使其不依赖实际的AST分析：

---

Read file: tests/unit/multi_language_analyzer_test.cpp

---

问题是测试试图分析实际的C++文件，但没有设置编译命令。多语言分析器内部使用CppAnalyzerAdapter，它需要配置的compile_commands.json或者其他编译信息才能正常工作。

让我修改测试，创建一个简化的方案。我需要设置一个有效的compile_commands.json或配置适当的回退参数：

---



---

还需要在文件顶部添加nlohmann/json包含：

---

Read file: tests/unit/multi_language_analyzer_test.cpp

---

我需要添加nlohmann/json包含：

---



---

现在让我们重新编译并测试：

---

```bash
cd /data/workspace/git/dlogcover && make -C build -j$(nproc) multi_language_analyzer_test
```

```
Cursor-1.0.0-x86_64.AppImage: 进入目录“/data/workspace/git/dlogcover/build”
Warning: 'f' is not in the list of known options, but still passed to Electron/Chromium.
WARNING: radv is not a conformant vulkan implementation, testing use only.
mesa: for the -simplifycfg-sink-common option: may only occur zero or one times!
mesa: for the -global-isel-abort option: may only occur zero or one times!
[24120:0617/094751.725545:ERROR:viz_main_impl.cc(185)] Exiting GPU process due to errors d
uring initialization
WARNING: radv is not a conformant vulkan implementation, testing use only.
mesa: for the -simplifycfg-sink-common option: may only occur zero or one times!
mesa: for the -global-isel-abort option: may only occur zero or one times!

Version:          Cursor 1.1.3 (979ba33804ac150108481c14e0b5cb970bda3260, 2025-06-15T06:37
:42.715Z)
OS Version:       Linux x64 4.19.0-amd64-desktop
CPUs:             Intel(R) Core(TM) i7-10700 CPU @ 2.90GHz (16 x 1897)
Memory (System):  15.59GB (8.16GB free)
Load (avg):       2, 2, 2
VM:               0%
Screen Reader:    no
Process Argv:     
GPU Status:       2d_canvas:                              unavailable_software
                  canvas_oop_rasterization:               disabled_off
                  direct_rendering_display_compositor:    disabled_off_ok
                  gpu_compositing:                        disabled_software
                  multiple_raster_threads:                enabled_on
                  opengl:                                 disabled_off
                  rasterization:                          disabled_software
                  raw_draw:                               disabled_off_ok
                  skia_graphite:                          disabled_off
                  video_decode:                           disabled_software
                  video_encode:                           disabled_software
                  vulkan:                                 disabled_off
                  webgl:                                  unavailable_software
                  webgl2:                                 unavailable_software
                  webgpu:                                 disabled_off
                  webnn:                                  unavailable_software

CPU %   Mem MB     PID  Process
    0      144   15377  cursor main
    0       16   15394     zygote
    4       96   15503       gpu-process
    0       16   15395     zygote
    0        0   15398       zygote
    1      686   15518  window [1] (dlogcover - Cursor)
    0       16   15766         utility-process
    0       32   15439     utility-network-service
    0       80   15625  shared-process
    0       64   15626  fileWatcher [1]
    0     1085   15703  extensionHost [1]
    0      239   15989       /home/ut000520@uos/.cursor/extensions/ms-vscode.cpptools-1.23
.6-linux-x64/bin/cpptools
    0       80   18696       /tmp/.mount_CursorDyDPQP/usr/share/cursor/cursor /tmp/.mount_
CursorDyDPQP/usr/share/cursor/resources/app/extensions/markdown-language-features/dist/ser
verWorkerMain --node-ipc --clientProcessId=15703
    0       80   15704  ptyHost
    0        0   15781       /usr/bin/bash --init-file /tmp/.mount_CursorDyDPQP/usr/share/
cursor/resources/app/out/vs/workbench/contrib/terminal/common/scripts/shellIntegration-bas
h.sh
    0        0   18741       /usr/bin/zsh -l
    0        0   24028         /home/ut000520@uos/Desktop/Cursor-1.0.0-x86_64.AppImage -C 
build -j16 multi_language_analyzer_test
    0      160   24030           /tmp/.mount_CursorN9vykV/usr/share/cursor/cursor -s -f CM
akeFiles/Makefile2 multi_language_analyzer_test
    0       48   24069             zygote
    0        0   24120               [cursor] <defunct>
    0       48   24070             zygote
    0        0   24073               zygote
    0       48   24127             utility-network-service
    0        0   24187             /bin/sh -c /usr/bin/ps -ax -o pid=,ppid=,pcpu=,pmem=,co
mmand=
    0        0   24188               /usr/bin/ps -ax -o pid=,ppid=,pcpu=,pmem=,command=

Workspace Stats: 
|  Window (dlogcover - Cursor)
|    Folder (dlogcover): 1392 files
|      File types: make(210) cmake(112) gcno(100) o(100) d(100) gcda(97)
|                  md(79) cpp(70) json(58) txt(46)
|      Conf files: cmake(112) makefile(4)


[24030:0617/094753.626602:ERROR:service_worker_storage.cc(2072)] Failed to delete the data
base: Database IO error
Cursor-1.0.0-x86_64.AppImage: 离开目录“/data/workspace/git/dlogcover/build”

```

---

看起来编译成功了，现在让我们测试：

---

```bash
cd /data/workspace/git/dlogcover/build && ./bin/multi_language_analyzer_test
```

```
Running main() from /build/googletest-lWsoze/googletest-1.8.1/googletest/src/gtest_main.cc
[==========] Running 11 tests from 1 test case.
[----------] Global test environment set-up.
[----------] 11 tests from MultiLanguageAnalyzerTest
[ RUN      ] MultiLanguageAnalyzerTest.BasicConstruction
[       OK ] MultiLanguageAnalyzerTest.BasicConstruction (1 ms)
[ RUN      ] MultiLanguageAnalyzerTest.CppOnlyMode
/data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:176: Failure
Value of: cppResult.isSuccess()
  Actual: false
Expected: true
C++文件分析应该成功
[  FAILED  ] MultiLanguageAnalyzerTest.CppOnlyMode (0 ms)
[ RUN      ] MultiLanguageAnalyzerTest.GoOnlyMode
sh: 1: /tmp/dlogcover_go_request.json: Permission denied
/data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:205: Failure
Value of: cppResult.isSuccess()
  Actual: false
Expected: true
C++文件应该被跳过但不报错
[  FAILED  ] MultiLanguageAnalyzerTest.GoOnlyMode (3 ms)
[ RUN      ] MultiLanguageAnalyzerTest.AutoDetectMode
/data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:226: Failure
Value of: cppResult.isSuccess()
  Actual: false
Expected: true
C++文件分析应该成功
[  FAILED  ] MultiLanguageAnalyzerTest.AutoDetectMode (0 ms)
[ RUN      ] MultiLanguageAnalyzerTest.InvalidAnalysisMode
/data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:248: Failure
Value of: result.isSuccess()
  Actual: false
Expected: true
无效模式应该回退到默认行为
[  FAILED  ] MultiLanguageAnalyzerTest.InvalidAnalysisMode (1 ms)
[ RUN      ] MultiLanguageAnalyzerTest.NonExistentFile
[       OK ] MultiLanguageAnalyzerTest.NonExistentFile (0 ms)
[ RUN      ] MultiLanguageAnalyzerTest.EmptyFile
/data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:276: Failure
Value of: result.isSuccess()
  Actual: false
Expected: true
空文件应该能正常处理
[  FAILED  ] MultiLanguageAnalyzerTest.EmptyFile (0 ms)
[ RUN      ] MultiLanguageAnalyzerTest.BatchAnalysis
/data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:304: Failure
Value of: result.isSuccess()
  Actual: false
Expected: true
文件 /tmp/dlogcover_test_multi_analyzer/test1.cpp 分析应该成功
/data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:304: Failure
Value of: result.isSuccess()
  Actual: false
Expected: true
文件 /tmp/dlogcover_test_multi_analyzer/test2.cpp 分析应该成功
[  FAILED  ] MultiLanguageAnalyzerTest.BatchAnalysis (1 ms)
[ RUN      ] MultiLanguageAnalyzerTest.Statistics
/data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:321: Failure
Value of: result.isSuccess()
  Actual: false
Expected: true
[  FAILED  ] MultiLanguageAnalyzerTest.Statistics (0 ms)
[ RUN      ] MultiLanguageAnalyzerTest.GoToolUnavailable
[       OK ] MultiLanguageAnalyzerTest.GoToolUnavailable (1 ms)
[ RUN      ] MultiLanguageAnalyzerTest.ParallelMode
[       OK ] MultiLanguageAnalyzerTest.ParallelMode (0 ms)
[----------] 11 tests from MultiLanguageAnalyzerTest (7 ms total)

[----------] Global test environment tear-down
[==========] 11 tests from 1 test case ran. (7 ms total)
[  PASSED  ] 4 tests.
[  FAILED  ] 7 tests, listed below:
[  FAILED  ] MultiLanguageAnalyzerTest.CppOnlyMode
[  FAILED  ] MultiLanguageAnalyzerTest.GoOnlyMode
[  FAILED  ] MultiLanguageAnalyzerTest.AutoDetectMode
[  FAILED  ] MultiLanguageAnalyzerTest.InvalidAnalysisMode
[  FAILED  ] MultiLanguageAnalyzerTest.EmptyFile
[  FAILED  ] MultiLanguageAnalyzerTest.BatchAnalysis
[  FAILED  ] MultiLanguageAnalyzerTest.Statistics

 7 FAILED TESTS

```

---

问题仍然存在。让我查看一下分析失败的具体原因。我需要修改测试来打印错误信息，这样能更好地了解失败的原因：

---



---

让我选择第一个出现的位置来修改：

---

Read file: tests/unit/multi_language_analyzer_test.cpp

---

现在我直接修改第一个失败的测试来添加错误信息输出：

---



---

让我使用行号进行精确定位：

---



---

让我使用更具体的上下文：

---



---

现在让我们重新编译并运行测试：

---

```bash
cd /data/workspace/git/dlogcover && make -C build -j$(nproc) multi_language_analyzer_test && ./build/bin/multi_language_analyzer_test --gtest_filter="MultiLanguageAnalyzerTest.CppOnlyMode"
```

```
Cursor-1.0.0-x86_64.AppImage: 进入目录“/data/workspace/git/dlogcover/build”
Warning: 'f' is not in the list of known options, but still passed to Electron/Chromium.
WARNING: radv is not a conformant vulkan implementation, testing use only.
mesa: for the -simplifycfg-sink-common option: may only occur zero or one times!
mesa: for the -global-isel-abort option: may only occur zero or one times!
[24895:0617/094920.379462:ERROR:viz_main_impl.cc(185)] Exiting GPU process due to errors d
uring initialization
WARNING: radv is not a conformant vulkan implementation, testing use only.
mesa: for the -simplifycfg-sink-common option: may only occur zero or one times!
mesa: for the -global-isel-abort option: may only occur zero or one times!
[main 2025-06-17T01:49:21.511Z] Error: cat: /proc/24895/stat: 没有那个文件或目录
/tmp/.mount_CursorKwi6Gm/usr/share/cursor/resources/app/out/vs/base/node/cpuUsage.sh:行27:
 let: PROCESS_TIME_BEFORE=+：语法错误: 需要操作数 (错误符号是 "+")                        
    at file:///tmp/.mount_CursorKwi6Gm/usr/share/cursor/resources/app/out/main.js:48:30217
    at ChildProcess.exithandler (node:child_process:414:7)
    at ChildProcess.emit (node:events:524:28)
    at maybeClose (node:internal/child_process:1104:16)
    at Socket.<anonymous> (node:internal/child_process:456:11)
    at Socket.emit (node:events:524:28)
    at Pipe.<anonymous> (node:net:343:12)
[24816:0617/094922.223437:ERROR:service_worker_storage.cc(2072)] Failed to delete the data
base: Database IO error
Cursor-1.0.0-x86_64.AppImage: *** [Makefile:680：multi_language_analyzer_test] 错误 1
Cursor-1.0.0-x86_64.AppImage: 离开目录“/data/workspace/git/dlogcover/build”

```

---

编译出错了。让我单独编译，然后再运行：

---

```bash
cd /data/workspace/git/dlogcover/build && make multi_language_analyzer_test -j4
```

```
Warning: 'f' is not in the list of known options, but still passed to Electron/Chromium.
WARNING: radv is not a conformant vulkan implementation, testing use only.
mesa: for the -simplifycfg-sink-common option: may only occur zero or one times!
mesa: for the -global-isel-abort option: may only occur zero or one times!
[27230:0617/095131.859353:ERROR:viz_main_impl.cc(185)] Exiting GPU process due to errors d
uring initialization
WARNING: radv is not a conformant vulkan implementation, testing use only.
mesa: for the -simplifycfg-sink-common option: may only occur zero or one times!
mesa: for the -global-isel-abort option: may only occur zero or one times!

Version:          Cursor 1.1.3 (979ba33804ac150108481c14e0b5cb970bda3260, 2025-06-15T06:37
:42.715Z)
OS Version:       Linux x64 4.19.0-amd64-desktop
CPUs:             Intel(R) Core(TM) i7-10700 CPU @ 2.90GHz (16 x 2539)
Memory (System):  15.59GB (8.17GB free)
Load (avg):       2, 2, 2
VM:               0%
Screen Reader:    no
Process Argv:     
GPU Status:       2d_canvas:                              unavailable_software
                  canvas_oop_rasterization:               disabled_off
                  direct_rendering_display_compositor:    disabled_off_ok
                  gpu_compositing:                        disabled_software
                  multiple_raster_threads:                enabled_on
                  opengl:                                 disabled_off
                  rasterization:                          disabled_software
                  raw_draw:                               disabled_off_ok
                  skia_graphite:                          disabled_off
                  video_decode:                           disabled_software
                  video_encode:                           disabled_software
                  vulkan:                                 disabled_off
                  webgl:                                  unavailable_software
                  webgl2:                                 unavailable_software
                  webgpu:                                 disabled_off
                  webnn:                                  unavailable_software

CPU %   Mem MB     PID  Process
    0      144   15377  cursor main
    0       16   15394     zygote
    4      112   15503       gpu-process
    0       16   15395     zygote
    0        0   15398       zygote
    1      686   15518  window [1] (dlogcover - Cursor)
    0       16   15766         utility-process
    0       32   15439     utility-network-service
    0       80   15625  shared-process
    0       64   15626  fileWatcher [1]
    0     1069   15703  extensionHost [1]
    0      160   15989       /home/ut000520@uos/.cursor/extensions/ms-vscode.cpptools-1.23
.6-linux-x64/bin/cpptools
    0       80   18696       /tmp/.mount_CursorDyDPQP/usr/share/cursor/cursor /tmp/.mount_
CursorDyDPQP/usr/share/cursor/resources/app/extensions/markdown-language-features/dist/ser
verWorkerMain --node-ipc --clientProcessId=15703
    0       80   15704  ptyHost
    0        0   15781       /usr/bin/bash --init-file /tmp/.mount_CursorDyDPQP/usr/share/
cursor/resources/app/out/vs/workbench/contrib/terminal/common/scripts/shellIntegration-bas
h.sh
    0        0   18741       /usr/bin/zsh -l
    0        0   27149         /home/ut000520@uos/Desktop/Cursor-1.0.0-x86_64.AppImage mul
ti_language_analyzer_test -j4
    0      160   27151           /tmp/.mount_CursorCDLRWL/usr/share/cursor/cursor -s -f CM
akeFiles/Makefile2 multi_language_analyzer_test
    0       48   27167             zygote
    0       64   27230               gpu-process
    0       48   27168             zygote
    0        0   27170               zygote
    0       48   27235             utility-network-service
    0        0   27267             /bin/sh -c /usr/bin/ps -ax -o pid=,ppid=,pcpu=,pmem=,co
mmand=
    0        0   27268               /usr/bin/ps -ax -o pid=,ppid=,pcpu=,pmem=,command=

Workspace Stats: 
|  Window (dlogcover - Cursor)
|    Folder (dlogcover): 1392 files
|      File types: make(210) cmake(112) gcno(100) o(100) d(100) gcda(97)
|                  md(79) cpp(70) json(58) txt(46)
|      Conf files: cmake(112) makefile(4)


[27151:0617/095133.709216:ERROR:service_worker_storage.cc(2072)] Failed to delete the data
base: Database IO error

```

---

好的，编译成功了。现在运行测试：

---

```bash
cd /data/workspace/git/dlogcover/build && ./bin/multi_language_analyzer_test --gtest_filter="MultiLanguageAnalyzerTest.CppOnlyMode"
```

```
Running main() from /build/googletest-lWsoze/googletest-1.8.1/googletest/src/gtest_main.cc
Note: Google Test filter = MultiLanguageAnalyzerTest.CppOnlyMode
[==========] Running 1 test from 1 test case.
[----------] Global test environment set-up.
[----------] 1 test from MultiLanguageAnalyzerTest
[ RUN      ] MultiLanguageAnalyzerTest.CppOnlyMode
/data/workspace/git/dlogcover/tests/unit/multi_language_analyzer_test.cpp:176: Failure
Value of: cppResult.isSuccess()
  Actual: false
Expected: true
C++文件分析应该成功
[  FAILED  ] MultiLanguageAnalyzerTest.CppOnlyMode (1 ms)
[----------] 1 test from MultiLanguageAnalyzerTest (1 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test case ran. (1 ms total)
[  PASSED  ] 0 tests.
[  FAILED  ] 1 test, listed below:
[  FAILED  ] MultiLanguageAnalyzerTest.CppOnlyMode

 1 FAILED TEST

```

---

奇怪，没有看到我添加的错误输出。让我再检查一下行号是否正确：

---

Read file: tests/unit/multi_language_analyzer_test.cpp

---

我看到代码已经修改了，但是控制台没有输出。这可能是因为测试框架捕获了标准输出。让我换一种方式，直接在测试失败时输出更多信息。

既然这个测试依赖于真正的C++分析，而当前的设置可能有问题，让我简化测试，使其更加健壮。我觉得问题可能在于AST分析器需要更多的设置。让我修改测试策略，创建一个更简单的测试，不依赖实际的AST分析：

# Mode: PLAN

## 单元测试错误修复总结

经过分析和修复，我已经成功解决了大部分单元测试错误：

### ✅ 已修复的问题

1. **nlohmann/json版本兼容性问题**
   - 问题：`parsed.contains("version")`方法在3.5.0版本中不存在
   - 修复：改为`parsed.count("version") > 0`

2. **语言检测器的大小写问题**
   - 问题：`.C`扩展名被转换为小写`.c`，但列表中是大写
   - 修复：将`CPP_EXTENSIONS`中的`.C`改为`.c`

3. **文件系统权限问题**
   - 问题：测试使用绝对路径如`/nonexistent/directory/path`引起权限错误
   - 修复：改为使用临时目录内的相对路径

### 🔄 当前状态

测试现在通过率达到**97%** (33/34个测试通过)，只剩下1个测试失败：

- `multi_language_analyzer_test` - 7个子测试失败

### 🚧 剩余问题分析

`MultiLanguageAnalyzerTest`失败的根本原因是：

1. **AST分析器依赖问题**：测试试图分析实际的C++文件，但AST分析器需要完整的编译环境
2. **配置不完整**：虽然创建了`compile_commands.json`，但还需要更多配置才能让分析器正常工作
3. **测试过于复杂**：这个测试依赖于整个分析链路，包括文件系统、编译器、AST解析等

### 📋 修复方案

对于剩余的`MultiLanguageAnalyzerTest`，建议采用以下策略之一：

**选项1：简化测试（推荐）**
- 模拟分析器返回结果，而不是依赖实际分析
- 专注测试多语言路由逻辑而非实际分析能力
- 使用Mock对象替代真实的分析器

**选项2：完善测试环境**
- 创建完整的测试项目结构
- 提供有效的编译命令和头文件
- 设置完整的Clang工具链环境

**选项3：降级为集成测试**
- 将复杂的多语言分析器测试移动到集成测试
- 在单元测试中只测试基本的构造和配置逻辑

鉴于当前的进展和测试通过率，推荐采用**选项1**来快速解决剩余问题，确保所有单元测试都能通过。

---

_**User**_

进入执行模式，执行修复方案

---

_**Assistant**_



---

