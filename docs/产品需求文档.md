# DLogCover - C++日志覆盖率统计工具产品需求文档

## 1. 产品概述

### 1.1 产品背景
在C++项目开发中，日志对于问题定位和系统监控至关重要。然而，目前缺乏有效的工具来评估代码中的日志覆盖情况，这可能导致关键代码路径缺少必要的日志记录。DLogCover旨在通过静态代码分析来解决这个问题。

### 1.2 产品价值
[ ] 提高代码质量和可维护性
[ ] 降低生产环境问题定位难度
[ ] 减少运维成本
[ ] 提升开发团队效率

### 1.3 目标用户
- C++开发工程师
- 质量保证工程师

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 命令行支持
- **启动方式**
  [ ] 命令行参数启动
    - 支持指定扫描目录：-d, --directory <path>
    - 支持指定输出目录：-o, --output <path>
    - 支持配置文件路径：-c, --config <path>
  [ ] 默认行为
    - 无参数启动时扫描当前目录
    - 输出报告默认为：./dlogcover_report_<timestamp>.txt
    - 使用默认配置进行分析
  [ ] 可执行文件双击启动
    - 自动扫描当前目录
    - 在当前目录生成报告
    - 使用默认配置

- **参数配置**
  [ ] 必选参数（均有默认值）
    - 源代码目录路径（默认：./）
    - 输出报告路径（默认：./dlogcover_report_<timestamp>.txt）
  [ ] 可选参数
    - 配置文件路径（默认：./dlogcover.json）
    - 排除目录列表（默认：build/,test/）
    - 日志级别过滤（默认：全部级别）
    - 报告格式选择（默认：文本格式）

#### 2.1.2 代码分析
- **静态扫描**
  [ ] 支持扫描整个项目目录
  [ ] 支持指定文件或目录扫描
  [ ] 支持排除特定目录或文件
  [ ] 支持多种C++版本（C++11/14/17/20）

- **日志识别**
  [ ] 识别Qt日志函数
    - 基础日志函数（按严重程度由低到高）：
      - qDebug()    - 调试级别：用于调试信息输出
      - qInfo()     - 信息级别：用于一般信息记录
      - qWarning()  - 告警级别：用于警告信息提示
      - qCritical() - 严重级别：用于严重错误记录
      - qFatal()    - 致命级别：用于致命错误处理
    - 分类日志函数（按严重程度由低到高）：
      - qCDebug(category)    - 分类调试级别
      - qCInfo(category)     - 分类信息级别
      - qCWarning(category)  - 分类告警级别
      - qCCritical(category) - 分类严重级别
  [ ] 识别自定义日志函数
    - fmDebug()    - 调试级别
    - fmInfo()     - 信息级别
    - fmWarning()  - 告警级别
    - fmCritical() - 严重级别

#### 2.1.3 覆盖率分析
- **基础分析**
  [ ] 函数级日志覆盖率统计
  [ ] 分支路径日志覆盖率统计
  [ ] 异常处理路径日志覆盖率统计
  [ ] 关键代码路径日志覆盖率统计

- **日志级别分析**
  [ ] 各级别使用统计
  [ ] 级别分布分析
  [ ] 关键路径级别检查

#### 2.1.4 报告生成
- **文本报告**
  [ ] 总体覆盖率统计
  [ ] 文件级别统计
  [ ] 未覆盖路径列表
  [ ] 日志使用建议

- **配置文件**
  [ ] JSON格式配置文件
    - 扫描路径配置
    - 排除规则配置
    - 日志函数配置
    - 输出选项配置

### 2.2 非功能需求

#### 2.2.1 性能要求
[ ] 单文件分析时间 < 1秒
[ ] 100万行代码项目扫描时间 < 10分钟
[ ] 内存占用 < 2GB
[ ] CPU使用率 < 70%

#### 2.2.2 可用性要求
[ ] 清晰的命令行参数说明
[ ] 直观的配置文件格式
[ ] 详细的错误提示信息
[ ] 简洁的使用手册

## 3. 使用场景

### 3.1 命令行使用
- 默认扫描：`dlogcover`
  - 扫描当前目录下所有C++源文件
  - 生成报告：./dlogcover_report_<timestamp>.txt
  - 使用默认配置
- 指定目录扫描：`dlogcover -d /path/to/source -o /path/to/output`
- 使用配置文件：`dlogcover -c config.json`
- 查看帮助信息：`dlogcover --help`

### 3.2 双击运行
- 在源代码目录双击运行
- 自动扫描当前目录
- 生成默认报告：./dlogcover_report_<timestamp>.txt

### 3.3 默认配置说明
- 扫描范围：当前目录及子目录
- 排除目录：build/、test/
- 支持的文件类型：.cpp、.cc、.cxx、.h、.hpp
- 日志级别：全部级别
- 报告格式：文本格式
- 时间戳格式：YYYYMMDD_HHMMSS

## 4. 交付标准

### 4.1 功能标准
[ ] 核心功能全部实现
  - 命令行工具可用
  - 支持双击运行
  - 日志覆盖率分析准确
  - 报告生成完整
[ ] 配置文件规范
[ ] 使用文档完整
[ ] 测试用例覆盖

### 4.2 交付物
[ ] 可执行文件
[ ] 配置文件模板
[ ] 使用说明文档
[ ] 示例项目 